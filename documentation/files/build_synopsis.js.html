<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>build/synopsis.js - synopsis</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../assets/css/logo.png" title="synopsis"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.2.0</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: build/synopsis.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==&quot;function&quot;&amp;&amp;require;if(!u&amp;&amp;a)return a(o,!0);if(i)return i(o,!0);var f=new Error(&quot;Cannot find module &#x27;&quot;+o+&quot;&#x27;&quot;);throw f.code=&quot;MODULE_NOT_FOUND&quot;,f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==&quot;function&quot;&amp;&amp;require;for(var o=0;o&lt;r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
module.exports={
  &quot;name&quot;: &quot;synopsis&quot;,
  &quot;version&quot;: &quot;0.2.0&quot;,
  &quot;repository&quot;: {
    &quot;type&quot;: &quot;git&quot;,
    &quot;url&quot;: &quot;https://github.com/schlegel/balloon-synopsis&quot;
  },
  &quot;devDependencies&quot;: {
    &quot;assemble-less&quot;: &quot;~0.7.0&quot;,
    &quot;browserify&quot;: &quot;~5.10.1&quot;,
    &quot;browserify-shim&quot;: &quot;~3.8.5&quot;,
    &quot;grunt&quot;: &quot;^0.4.0&quot;,
    &quot;grunt-bower-requirejs&quot;: &quot;~1.1.0&quot;,
    &quot;grunt-bower-task&quot;: &quot;~0.4.0&quot;,
    &quot;grunt-browserify&quot;: &quot;~3.7.0&quot;,
    &quot;grunt-contrib-clean&quot;: &quot;~0.6.0&quot;,
    &quot;grunt-contrib-copy&quot;: &quot;~0.5.0&quot;,
    &quot;grunt-contrib-handlebars&quot;: &quot;~0.5.4&quot;,
    &quot;grunt-contrib-jasmine&quot;: &quot;~0.8.2&quot;,
    &quot;grunt-contrib-jshint&quot;: &quot;~0.4.1&quot;,
    &quot;grunt-contrib-yuidoc&quot;: &quot;~0.5.0&quot;,
    &quot;grunt-wiredep&quot;: &quot;~1.7.1&quot;
  },
  &quot;browserify-shim&quot;: {
    &quot;jquery&quot;: &quot;global:$&quot;,
    &quot;handlebars&quot;: &quot;global:Handlebars&quot;,
    &quot;bows&quot;: &quot;global:bows&quot;,
    &quot;rdfstore&quot;: &quot;global:rdfstore&quot;,
    &quot;modernizr&quot;: &quot;global:Modernizr&quot;,
    &quot;backbone&quot;: &quot;global:Backbone&quot;,
    &quot;cytoscape&quot;: &quot;global:cytoscape&quot;,
    &quot;md5&quot;: &quot;global:md5&quot;,
    &quot;chroma-js&quot;: &quot;global:chroma&quot;,
    &quot;js-md5&quot;: &quot;global:md5&quot;
  },
  &quot;browserify&quot;: {
    &quot;transform&quot;: [
      &quot;browserify-shim&quot;
    ]
  }
}

},{}],2:[function(require,module,exports){
var name = require(&quot;./general_plugin.js&quot;).name;
var css = {
    &quot;monolog&quot;: &quot;monolog&quot;,
    &quot;fadeIn&quot;: &quot;fadeIn&quot;,
    &quot;flex&quot;: &quot;flex&quot;,
    &quot;show&quot;: &quot;show&quot;,
    &quot;tile&quot;: &quot;tile&quot;,
    &quot;flex_parent&quot;: &quot;flex_parent&quot;,
    &quot;menu&quot;: &quot;menu&quot;,
    &quot;overlay_menu&quot;: &quot;overlay_menu&quot;,
    &quot;overlay&quot;: &quot;overlay&quot;,
    &quot;history&quot;: &quot;history&quot;,
    &quot;menu_label&quot;: &quot;menu_label&quot;,
    &quot;overlay_container&quot;: &quot;overlay_container&quot;,
    &quot;overlay_content&quot;: &quot;overlay_content&quot;,
    &quot;filter&quot;: &quot;filter&quot;,
    &quot;filter_btn&quot;: &quot;filter_btn&quot;,
    &quot;sorter&quot;: &quot;sorter&quot;,
    &quot;named_node&quot;: &quot;named_node&quot;,
    &quot;layer&quot;: &quot;layer&quot;,
    &quot;layout_container&quot;: &quot;layout_container&quot;,
    &quot;dropdown&quot;: &quot;dropdown&quot;,
    &quot;dropdown_item&quot;: &quot;dropdown_item&quot;,
    &quot;btn&quot;: &quot;btn&quot;,
    &quot;btn_toolbar&quot;: &quot;btn_toolbar&quot;,
    &quot;btn_grp&quot;: &quot;btn_grp&quot;,
    &quot;navbar_collapse&quot;: &quot;navbar_collapse&quot;,
    &quot;navbar_nav&quot;: &quot;navbar_nav&quot;,
    &quot;navbar_nav_item&quot;: &quot;navbar_nav_item&quot;,
    &quot;progress_container&quot;: &quot;progress_container&quot;,
    &quot;progress_bar&quot;: &quot;progress_bar&quot;,
    &quot;progress_container_wrap&quot;: &quot;progress_container_wrap&quot;,
    &quot;no_scroll&quot;: &quot;no_scroll&quot;,
    &quot;scroll_box&quot;: &quot;scroll_box&quot;,
    &quot;scroll_box_content&quot;: &quot;scroll_box_content&quot;,
    &quot;layout_footer&quot;: &quot;layout_footer&quot;,
    &quot;semantic_color&quot;: &quot;semantic_color&quot;,
    &quot;uri&quot;: &quot;uri&quot;,
    &quot;label&quot;: &quot;label&quot;,
    &quot;uri_to_label&quot;: &quot;uri_to_label&quot;,
    &quot;dynamic_text_size&quot;: &quot;dynamic_text_size&quot;,
    &quot;shrink&quot;: &quot;shrink&quot;,
    &quot;y_scroll&quot;: &quot;y_scroll&quot;,
    &quot;thumbnail&quot;: &quot;thumbnail&quot;,
    &quot;hidden&quot;: &quot;hidden&quot;,
    &quot;disabled&quot;: &quot;disabled&quot;,
    &quot;literal&quot;: &quot;literal&quot;
};
var prefix = require(&quot;./general_plugin.js&quot;).prefix ? require(&quot;./general_plugin.js&quot;).prefix : name.length &gt;= 3 ? name.substr(0, 3) + &quot;_&quot; : name + &quot;_&quot;;

var keys = Object.keys(css);
for (var i = 0; i &lt; keys.length; i++) {
    css[keys[i]] = prefix + css[keys[i]];
}


module.exports = css;
},{&quot;./general_plugin.js&quot;:3}],3:[function(require,module,exports){
var package_json = require(&quot;../../../package.json&quot;);

var misc = {
    &quot;name&quot;: package_json.name,
    &quot;sorter-prefix&quot;: &quot;sorter-&quot;,
    &quot;filter-prefix&quot;: &quot;filter-&quot;
};

if (!misc.hasOwnProperty(&quot;prefix&quot;)) {
    misc.prefix = misc.name.length &gt;= 3 ? misc.name.substr(0, 3) + &quot;_&quot; : &quot;&quot;;
}

module.exports = misc;
},{&quot;../../../package.json&quot;:1}],4:[function(require,module,exports){
var decorators = {keys_for_decorators: []};

var add = function (Decorator) {
    var decorator = new Decorator();
    decorators[decorator.id] = decorator;
    decorators.keys_for_decorators.push(decorator.id);
};

add(require(&quot;./decorators/animal_detection_part&quot;));
add(require(&quot;./decorators/item_image&quot;));
add(require(&quot;./decorators/browsability&quot;));
add(require(&quot;./decorators/semantic_color&quot;));
add(require(&quot;./decorators/uri_to_label&quot;));
add(require(&quot;./decorators/uri_to_thumbnail&quot;));
add(require(&quot;./decorators/text_size&quot;));

module.exports = decorators;
},{&quot;./decorators/animal_detection_part&quot;:5,&quot;./decorators/browsability&quot;:6,&quot;./decorators/item_image&quot;:7,&quot;./decorators/semantic_color&quot;:8,&quot;./decorators/text_size&quot;:9,&quot;./decorators/uri_to_label&quot;:10,&quot;./decorators/uri_to_thumbnail&quot;:11}],5:[function(require,module,exports){
var log = require(&quot;../../logger&quot;)(&quot;Browsability decorator&quot;), info = require(&#x27;../../info&#x27;), Layer_factory = require(&quot;../../layers/factory&quot;);
var Debounced_remote = require(&quot;../../remote/debounced_remote&quot;);
RDFModel = window.RDFModel;

var Decorator = function () {
    this.id = &quot;animal_detection_part&quot;;
    this.config = {
        &quot;outgoing.named&quot;: function (draft) {
            return draft.triple.object;
        }
    };
    this.decorate = function (divs, synopsis, config, cb) {
        var debounced_remote_loader = new Debounced_remote(synopsis, &quot;SELECT DISTINCT ?value ?animal ?coord ?lo WHERE { ?value &lt;http://www.w3.org/ns/oa#hasBody&gt; ?body. ?body rdf:type &lt;http://www.mico-project.eu/ns/mmmterms/2.0/schema#AnimalDetectionBody&gt;.&quot; +
            &quot;?body rdf:value ?animal. ?value &lt;http://www.mico-project.eu/ns/mmm/2.0/schema#hasTarget&gt; ?target. ?target &lt;http://www.mico-project.eu/ns/mmm/2.0/schema#hasSelector&gt; ?selector. ?selector rdf:value ?coord. &quot; + Debounced_remote.dummy + &quot; }&quot;, null);
        for (var i = 0; i &lt; divs.length; i++) {
            var div = $(divs[i]);
            var type = div.data(&quot;type&quot;);
            if (config.hasOwnProperty(type)) {
                div.on(&quot;appended&quot;, function (d, part_uri) {
                    debounced_remote_loader.add_value(part_uri, function (bindings) {
                        if (bindings.length &gt; 0) {
                            d.append(&quot;&lt;b&gt;Found animal:&lt;/b&gt; &lt;div&gt;&quot;+bindings[0].animal.value+&quot;&lt;/div&gt;&quot;);
                            d.append(&quot;&lt;b&gt;On coordiantes&lt;/b&gt; &lt;div&gt;&quot;+bindings[0].coord.value+&quot;&lt;/div&gt;&quot;);
                        }
                    });
                }(div, config[type](div.data(&quot;draft_data&quot;))));
            }
        }
        if (cb)
            cb(divs);
        return divs;
    }
};

module.exports = Decorator;
},{&quot;../../info&quot;:27,&quot;../../layers/factory&quot;:30,&quot;../../logger&quot;:37,&quot;../../remote/debounced_remote&quot;:42}],6:[function(require,module,exports){
var log = require(&quot;../../logger&quot;)(&quot;Browsability decorator&quot;), info = require(&#x27;../../info&#x27;), Layer_factory = require(&quot;../../layers/factory&quot;);
RDFModel = window.RDFModel;

var Decorator = function () {
    this.id = &quot;browsability&quot;;
    this.config = {
        &quot;outgoing.named&quot;: function (draft) {
            return draft.triple.object;
        }, &quot;item&quot;: function (draft) {
            return draft.leads_to;
        }
    };
    this.decorate = function (divs, synopsis, config, cb) {
        for (var i = 0; i &lt; divs.length; i++) {
            var div = $(divs[i]);
            var type = div.data(&quot;type&quot;);
            if (config.hasOwnProperty(type)) {
                div.on(&quot;click&quot;, function (target_resource, data) {
                    return function () {
                        var layer = target_resource.interfaceName ? Layer_factory.make(synopsis, target_resource, target_resource.interfaceName) : Layer_factory.make(synopsis, target_resource);
                        if (data[&quot;post_view_cbs&quot;]) {
                            layer.post_view_cbs = data[&quot;post_view_cbs&quot;];
                            synopsis.show(layer, function (view) {
                                // Get callback functions to call after showing layer
                                for (var i = 0, ilen = view.layer.post_view_cbs.length; i &lt; ilen; i++) {
                                    view.layer.post_view_cbs[i].apply(null, arguments);
                                }
                                if (cb)
                                    cb.apply(null, arguments);
                            });
                        } else {
                            synopsis.show(layer, cb);
                        }
                    };
                }(config[type](div.data(&quot;draft_data&quot;)), div.data()));
            }
        }
        if (cb)
            cb(divs);
        return divs;
    }
};

module.exports = Decorator;
},{&quot;../../info&quot;:27,&quot;../../layers/factory&quot;:30,&quot;../../logger&quot;:37}],7:[function(require,module,exports){
var log = require(&quot;../../logger&quot;)(&quot;Browsability decorator&quot;), info = require(&#x27;../../info&#x27;), Layer_factory = require(&quot;../../layers/factory&quot;);
var Debounced_remote = require(&quot;../../remote/debounced_remote&quot;);
RDFModel = window.RDFModel;

var Decorator = function () {
    this.id = &quot;item_image&quot;;
    this.config = {
        dref : &quot;http://mico-platform:8080/broker/status/download?itemUri=&quot;,
        types : {
            &quot;item&quot;: function (draft) {
                return draft.leads_to.nominalValue;
            }
        }
    };
    this.decorate = function (divs, synopsis, config, cb) {
        var debounced_remote_loader = new Debounced_remote(synopsis, &quot;SELECT DISTINCT ?value ?asset ?type ?format WHERE { ?value &lt;http://www.mico-project.eu/ns/mmm/2.0/schema#hasAsset&gt; ?asset . ?asset &lt;http://purl.org/dc/elements/1.1/format&gt; ?format. ?asset &lt;http://purl.org/dc/elements/1.1/format&gt; ?format. &quot; + Debounced_remote.dummy + &quot; }&quot;, null);
        for (var i = 0; i &lt; divs.length; i++) {
            var div = $(divs[i]);
            var type = div.data(&quot;type&quot;);
            if (config[&quot;types&quot;].hasOwnProperty(type)) {
                div.on(&quot;appended&quot;, function (d, part_uri) {
                    debounced_remote_loader.add_value(part_uri, function (bindings) {
                        if (bindings.length &gt; 0 &amp;&amp; (bindings[0][&quot;format&quot;].value == &quot;image/png&quot; || bindings[0][&quot;format&quot;].value == &quot;image/jpeg&quot; || bindings[0][&quot;format&quot;].value == &quot;image/jpg&quot;)) {
                            if (!d.data(&quot;image&quot;)) {
                                d.data(&quot;image&quot;, bindings[0][&quot;asset&quot;].value);
                                var width = d.width() - 20;
                                d.prepend(&quot;&lt;div class=&#x27;&quot; + CSS.shrink + &quot;&#x27;&gt;&lt;img class=&quot;+ CSS.thumbnail +&quot; src=&#x27;&quot;+config[&quot;dref&quot;]+bindings[0][&quot;value&quot;].value+&quot;&#x27; width=&#x27;&quot;+ width +&quot;&#x27;&gt;&lt;/div&gt;&quot;);
                            }
                        }
                    });
                }(div, config[&quot;types&quot;][type](div.data(&quot;draft_data&quot;))));
            }
        }
        if (cb)
            cb(divs);
        return divs;
    }
};

module.exports = Decorator;
},{&quot;../../info&quot;:27,&quot;../../layers/factory&quot;:30,&quot;../../logger&quot;:37,&quot;../../remote/debounced_remote&quot;:42}],8:[function(require,module,exports){
(function (global){
var log = require(&quot;../../logger&quot;)(&quot;Browsability decorator&quot;), chroma = (typeof window !== &quot;undefined&quot; ? window[&#x27;chroma&#x27;] : typeof global !== &quot;undefined&quot; ? global[&#x27;chroma&#x27;] : null), md5 = (typeof window !== &quot;undefined&quot; ? window[&#x27;md5&#x27;] : typeof global !== &quot;undefined&quot; ? global[&#x27;md5&#x27;] : null), CSS = require(&quot;../../const/css&quot;);
var Debounced_remote = require(&quot;../../remote/debounced_remote&quot;);
RDFModel = window.RDFModel;

var color_map = {};

var add_to_color_map = function (uri, types, cb) {
    if (!color_map[uri])
        color_map[uri] = {types: [], final_color: null};
    for (var i = 0; i &lt; types.length; i++) {
        var type = types[i].o.value ? types[i].o.value : types[i].o.nominalValue;
        color_map[uri].types[i] = {uri: type, color: chroma(&quot;#&quot; + md5(type).substring(0, 6))};
        if (!color_map[uri].final_color) {
            color_map[uri].final_color = color_map[uri].types[i].color;
        } else {
            var scale = chroma.scale([color_map[uri].final_color.hex(), &quot;#&quot; + md5(type).substring(0, 6)]).mode(&#x27;lab&#x27;);
            color_map[uri].final_color = chroma(scale(0.5).hex());
        }
    }
    cb();
};

var colorize = function (ele, uri) {
    if (color_map[uri]) {
        var $ele = $(ele);

        // Add color to newly opened layers
        var post_view_cbs = $ele.data(&quot;post_view_cbs&quot;);
        if (!post_view_cbs) {
            $ele.data(&quot;post_view_cbs&quot;, []);
            post_view_cbs = $ele.data(&quot;post_view_cbs&quot;);
        }
        post_view_cbs.push(function (color) {
            return function (view) {
                view.layer.set_color(color);
                view.overlay.set_color(color);
                return view;
            }
        }(color_map[uri].final_color));
        $ele.data(&quot;post_view_cbs&quot;, post_view_cbs);

        // Color segments of div which are marked with semantic_color class
        if ($ele.hasClass(CSS.semantic_color)) {
            $(ele).css(&quot;background-color&quot;, color_map[uri].final_color);
        }
        $ele.find(&quot;.&quot; + CSS.semantic_color).css(&quot;background-color&quot;, color_map[uri].final_color);
        return true;
    } else {
        return false;
    }
};

var Decorator = function () {
    this.id = &quot;semantic_color&quot;;
    this.config = {
        &quot;outgoing.named&quot;: function (draft) {
            return draft.triple.object.nominalValue;
        }, &quot;item&quot;: function (draft) {
            return draft.leads_to.nominalValue;
        }
    };
    this.decorate = function (divs, synopsis, config, cb) {
        var debounced_remote_loader = new Debounced_remote(synopsis, &quot;SELECT DISTINCT ?value ?o WHERE {?value rdf:type ?o. &quot; + Debounced_remote.dummy + &quot; }&quot;, null);
        for (var i = 0; i &lt; divs.length; i++) {
            var div = divs[i];
            var type = div.data(&quot;type&quot;);
            if (config.hasOwnProperty(type)) {
                div.on(&quot;appended&quot;, function (d, uri_fn) {
                    var resource_uri = uri_fn(d.data(&quot;draft_data&quot;));
                    return function () {
                        if (!colorize(d, resource_uri)) {
                            var color_query = &quot;SELECT DISTINCT ?o WHERE {&lt;&quot; + resource_uri + &quot;&gt; rdf:type ?o. }&quot;;
                            synopsis.store_wrap.store.execute(color_query, function (e, res) {
                                if (res == undefined || res.length == 0) {
                                    debounced_remote_loader.add_value(resource_uri, function (bindings) {
                                        if (!colorize(d, resource_uri) &amp;&amp; bindings.length &gt; 0) {
                                            add_to_color_map(resource_uri, bindings, function () {
                                                colorize(d, resource_uri);
                                            })
                                        }
                                    });
                                } else {
                                    add_to_color_map(resource_uri, res, function () {
                                        colorize(d, resource_uri);
                                    })
                                }
                            });

                        }
                        if (resource_uri.indexOf(RDFModel.rdf.prefixes.rdfs) != -1 || resource_uri.indexOf(RDFModel.rdf.prefixes.owl) !== -1) {
                            // TODO rdfs and owl as unimportant
                        }
                    };
                }(div, config[type]));
            }
        }
        if (cb)
            cb(divs);
        return divs;
    }
};

module.exports = Decorator;
}).call(this,typeof global !== &quot;undefined&quot; ? global : typeof self !== &quot;undefined&quot; ? self : typeof window !== &quot;undefined&quot; ? window : {})
},{&quot;../../const/css&quot;:2,&quot;../../logger&quot;:37,&quot;../../remote/debounced_remote&quot;:42}],9:[function(require,module,exports){
var log = require(&quot;../../logger&quot;)(&quot;Browsability decorator&quot;), CSS = require(&quot;../../const/css&quot;);
RDFModel = window.RDFModel;

// ========================= JQuery textfill
// https://gist.github.com/mekwall/1263939 Source code by Marcus Ekwall
// Modifications by Thomas Wei√ügerber
(function ($) {
    $.fn.textfill = function (maxFontSize, minFontSize, fail) {
        maxFontSize = parseInt(maxFontSize, 10);
        minFontSize = parseInt(minFontSize, 10);
        return this
            .each(function (i, val) {
                var ourText = $(val), parent = ourText.parent(), maxHeight = parent.height(), maxWidth = parent
                    .width(), fontSize = parseInt(ourText.css(&quot;fontSize&quot;), 10), tmpMultW = maxWidth
                    / ourText.width(), tmpMultH = maxHeight / ourText.height(), multiplier = (tmpMultW &lt; tmpMultH) ? tmpMultW
                    : tmpMultH, newSize = (fontSize * (multiplier - 0.1));
                if (maxFontSize &gt; 0 &amp;&amp; newSize &gt; maxFontSize) {
                    newSize = maxFontSize;
                }
                if (minFontSize &gt; 0 &amp;&amp; newSize &lt; minFontSize) {
                    fail(parent);
                    newSize = minFontSize;
                    ourText.css(&quot;fontSize&quot;, newSize);
                } else {
                    ourText.css(&quot;fontSize&quot;, newSize);
                    while (parent.get(0).scrollWidth &gt; parent.width()) {
                        minFontSize--;
                        if (minFontSize &gt; 0 &amp;&amp; newSize &lt; minFontSize) {
                            fail(parent);
                            newSize = minFontSize;
                            ourText.css(&quot;fontSize&quot;, newSize);
                            break;
                        } else {
                            ourText.css(&quot;fontSize&quot;, newSize);
                        }
                    }
                }
            });
    };
})(jQuery);

var Decorator = function () {
    this.id = &quot;text_size&quot;;
    this.decorate = function (divs, synopsis, config, cb) {
        for (var i = 0; i &lt; divs.length; i++) {
            var div = $(divs[i]);
            var dyn_text_div = div.find(&quot;.&quot; + CSS.dynamic_text_size);
            dyn_text_div.textfill(80, 12, function ($parent) {
                $parent.css({
                    &quot;overflow-y&quot;: &quot;auto&quot;,
                    &quot;word-wrap&quot;: &quot;break-word&quot;
                })
            });
        }
        if (cb)
            cb(divs);
        return divs;
    }
};

module.exports = Decorator;
},{&quot;../../const/css&quot;:2,&quot;../../logger&quot;:37}],10:[function(require,module,exports){
var log = require(&quot;../../logger&quot;)(&quot;URI_TO_LABEL decorator&quot;), CSS = require(&quot;../../const/css&quot;);
var Debounced_remote = require(&quot;../../remote/debounced_remote&quot;);

var label_map = {};

var add_to_label_map = function (uri, labels, cb) {
    if (!label_map[uri]) {
        label_map[uri] = {};
    }
    for (var i = 0; i &lt; labels.length; i++) {
        var language = labels[i].o[&quot;xml:lang&quot;] ? labels[i].o[&quot;xml:lang&quot;] : &quot;undefined&quot;;
        label_map[uri][language] = labels[i].o;
    }
    cb();
};

var labelize = function (ele, uri, language) {
    if (label_map[uri]) {
        var label = label_map[uri][language] ? label_map[uri][language].value : label_map[uri][&quot;undefined&quot;] ? label_map[uri][&quot;undefined&quot;].value : label_map[uri][Object.keys(label_map[uri])[0]].value;
        ele.text(label);
        ele.addClass(CSS.uri_to_label);
        $(ele).prop(&quot;title&quot;, uri);
        $(ele).tooltipster({interactive: true}); //fix multiple call
        return true;
    } else {
        return false;
    }
};

var Decorator = function () {
    this.id = &quot;uri_to_label&quot;;
    this.config = {
        &quot;outgoing.blank&quot;: true,
        &quot;outgoing.literal&quot;: true,
        &quot;outgoing.named&quot;: true,
        &quot;incoming.blank&quot;: true,
        &quot;incoming.named&quot;: true,
        &quot;multi.named&quot;: true
    };
    var isValidUri = function (value) {
        return /^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})).?)(?::\d{2,5})?(?:[/?#]\S*)?$/i.test( value );
    };

    this.decorate = function (divs, synopsis, config, cb) {
        var language = synopsis.msg.get_language();
        var debounced_remote_loader = new Debounced_remote(synopsis, &quot;SELECT DISTINCT ?value ?o WHERE { ?value rdfs:label ?o.&quot; + Debounced_remote.dummy + &quot; }&quot;, null);
        for (var i = 0; i &lt; divs.length; i++) {
            var div = $(divs[i]);
            var type = div.data(&quot;type&quot;);
            if (config.hasOwnProperty(type)) {
                div.on(&quot;appended&quot;, function (d) {
                    return function () {
                        var eles = d.find(&quot;.&quot; + CSS.uri);
                        eles.each(function (i, ele) {

                            // At first save the content of the element as uri data for the element
                            ele = $(ele);
                            if (!ele.data(&quot;uri&quot;))
                                ele.data(&quot;uri&quot;, ele.text().trim());

                            // Get uri and check if we can labelize it
                            var uri = ele.data(&quot;uri&quot;);
                            if (isValidUri(uri) &amp;&amp; !labelize(ele, uri, language)) {
                                var label_query = &quot;SELECT DISTINCT ?o WHERE {{&lt;&quot; + uri + &quot;&gt; rdfs:label ?o. } UNION {&lt;&quot; + uri + &quot;&gt; foaf:name ?o. }}&quot;;
                                synopsis.store_wrap.store.execute(label_query, function (_ele, _uri) {
                                    return function (_, res) {
                                        if (res.length == 0) {
                                            debounced_remote_loader.add_value(_uri, function (__ele, __uri) {
                                                return function (bindings) {
                                                    if (!labelize(__ele, __uri, language)) {
                                                        if (bindings.length &gt; 0) {
                                                            add_to_label_map(__uri, bindings, function () {
                                                                labelize(__ele, __uri, language);
                                                            })
                                                        } else {
                                                            var splitted = __uri.split(&quot;/&quot;);
                                                            var label = null;
                                                            for (var i = splitted.length - 1; i &gt; 0; i--) {
                                                                if (splitted[i].length &gt; 0) {
                                                                    label = splitted[i];
                                                                    break;
                                                                }
                                                            }
                                                            add_to_label_map(__uri, [{
                                                                o: {
                                                                    value: label,
                                                                    type: &quot;extracted&quot;
                                                                }
                                                            }], function () {
                                                                labelize(__ele, __uri, language);
                                                            })
                                                        }
                                                    }
                                                }
                                            }(_ele, _uri));
                                        } else {
                                            add_to_label_map(_uri, res, function () {
                                                labelize(_ele, _uri, language);
                                            })
                                        }
                                    }
                                }(ele, uri));
                            }
                        });
                    }
                }(div));
            }
        }
        if (cb)
            cb(divs);
        return divs;
    }
};

module.exports = Decorator;
},{&quot;../../const/css&quot;:2,&quot;../../logger&quot;:37,&quot;../../remote/debounced_remote&quot;:42}],11:[function(require,module,exports){
var log = require(&quot;../../logger&quot;)(&quot;URI_TO_THUMBNAIL decorator&quot;), CSS = require(&quot;../../const/css&quot;);
var Debounced_remote = require(&quot;../../remote/debounced_remote&quot;);

var image_map = {};

var add_to_image_map = function (uri, labels, cb) {
    if (!image_map[uri]) {
        image_map[uri] = {};
    }
    for (var i = 0; i &lt; labels.length; i++) {
        image_map[uri][labels[i].o.value] = labels[i].o;
    }
    cb();
};

var imageify = function (ele, uri) {
    if (image_map[uri]) {
        var tile = ele.closest(&quot;.&quot;+CSS.tile);
        if (!tile.data(&quot;image&quot;)) {
            var image_uris = Object.keys(image_map[uri]);
            //ele.css(&quot;background-image&quot;, &quot;url(&quot;+image_map[uri][0]+&quot;)&quot;);
            tile.data(&quot;image&quot;, image_uris[0]);
            var width = tile.width() - 20;
            tile.prepend(&quot;&lt;div class=&#x27;&quot; + CSS.shrink + &quot;&#x27;&gt;&lt;img class=&quot;+ CSS.thumbnail +&quot; src=&#x27;&quot;+image_uris[0]+&quot;&#x27; width=&#x27;&quot;+ width +&quot;&#x27;&gt;&lt;/div&gt;&quot;);
        }
        return true;
    } else {
        return false;
    }
};

var Decorator = function () {
    this.id = &quot;uri_to_image&quot;;
    this.config = {
        &quot;outgoing.blank&quot;: true,
        &quot;outgoing.literal&quot;: true,
        &quot;outgoing.named&quot;: true,
        &quot;incoming.blank&quot;: true,
        &quot;incoming.named&quot;: true,
        &quot;multi.named&quot;: true
    };
    this.decorate = function (divs, synopsis, config, cb) {
        var debounced_remote_loader = new Debounced_remote(synopsis, &quot;SELECT DISTINCT ?value ?o WHERE { ?value &lt;http://dbpedia.org/ontology/thumbnail&gt; ?o.&quot; + Debounced_remote.dummy + &quot; }&quot;, null);
        for (var i = 0; i &lt; divs.length; i++) {
            var div = $(divs[i]);
            var type = div.data(&quot;type&quot;);
            if (config.hasOwnProperty(type)) {
                div.on(&quot;appended&quot;, function (d) {
                    return function () {
                        var eles = d.find(&quot;.&quot; + CSS.uri);
                        eles.each(function (i, ele) {

                            // At first save the content of the element as uri data for the element
                            ele = $(ele);
                            if (!ele.data(&quot;uri&quot;))
                                ele.data(&quot;uri&quot;, ele.text().trim());

                            // Get uri and check if we can imageify it
                            var uri = ele.data(&quot;uri&quot;);
                            if (!imageify(ele, uri)) {
                                var image_query = &quot;SELECT DISTINCT ?o WHERE {{&lt;&quot; + uri + &quot;&gt; &lt;http://dbpedia.org/ontology/thumbnail&gt; ?o. } UNION {&lt;&quot; + uri + &quot;&gt; foaf:name ?o. }}&quot;;
                                synopsis.store_wrap.store.execute(image_query, function (_ele, _uri) {
                                    return function (_, res) {
                                        if (res.length == 0) {
                                            debounced_remote_loader.add_value(_uri, function (__ele, __uri) {
                                                return function (bindings) {
                                                    if (!imageify(__ele, __uri)) {
                                                        if (bindings.length &gt; 0) {
                                                            add_to_image_map(__uri, bindings, function () {
                                                                imageify(__ele, __uri);
                                                            })
                                                        }
                                                    }
                                                }
                                            }(_ele, _uri));
                                        } else {
                                            add_to_image_map(_uri, res, function () {
                                                imageify(_ele, _uri);
                                            })
                                        }
                                    }
                                }(ele, uri));
                            }
                        });
                    }
                }(div));
            }
        }
        if (cb)
            cb(divs);
        return divs;
    }
};

module.exports = Decorator;
},{&quot;../../const/css&quot;:2,&quot;../../logger&quot;:37,&quot;../../remote/debounced_remote&quot;:42}],12:[function(require,module,exports){
var log = require(&quot;./../logger&quot;)(&quot;Decorator_manager&quot;);

var decorators = require(&quot;./decorators.js&quot;);

var defaults = {
    decorators: decorators
};

var Manager = function (opt, synopsis) {
    this.synopsis = synopsis;
    this._opt = $.extend(true, {}, defaults, opt);
    var decorator_keys = Object.keys(defaults.decorators);
    if (opt.decorators)
        for (var i = 0; i &lt; decorator_keys.length; i++) {
            if (opt.decorators[decorator_keys[i]])
                this._opt.decorators[decorator_keys[i]] = $.extend(true, {}, defaults.decorators[decorator_keys[i]], opt.decorators[decorator_keys[i]]);
        }
};

Manager.prototype.decorate = function (divs, cb) {
    for (var i = 0; i &lt; this._opt.decorators.keys_for_decorators.length; i++) {
        divs = this._opt.decorators[this._opt.decorators.keys_for_decorators[i]].decorate(divs, synopsis, this._opt.decorators[this._opt.decorators.keys_for_decorators[i]].config);
    }
    if (cb)
        cb(divs);
    return divs;
};

module.exports = Manager;
},{&quot;./../logger&quot;:37,&quot;./decorators.js&quot;:4}],13:[function(require,module,exports){
var templating = require(&quot;../../templating&quot;), Base_detripler = require(&quot;../scheme&quot;), CSS = require(&quot;../../const/css&quot;);

var ID = &quot;outgoing.blank&quot;;

var Detripler = function () {
    Base_detripler.call(this, ID);
    this.worker = true;
    this.template_id = &quot;tiles.outgoing.blank&quot;;
    this.fn = function (triples, transport, cb) {
        var draft = [];
        transport.get_concept(&quot;outgoing.BlankNode&quot;, function (blank) {
            if (blank) {
                while (blank.length &gt; 0) {
                    var index = blank.pop();
                    var triple = triples[index];
                    draft.push({direction: &quot;out&quot;, triple: triple});
                }
            }
            cb(draft);
        });
    };

};

Detripler.prototype = Object.create(Base_detripler.prototype);
Detripler.prototype.constructor = Detripler;

module.exports = Detripler;
},{&quot;../../const/css&quot;:2,&quot;../../templating&quot;:47,&quot;../scheme&quot;:22}],14:[function(require,module,exports){
var templating = require(&quot;../../templating&quot;), Base_detripler = require(&quot;../scheme&quot;), CSS = require(&quot;../../const/css&quot;);

var ID = &quot;outgoing.literal&quot;;

var Detripler = function () {
    Base_detripler.call(this, ID);
    this.worker = true;
    this.template_id = &quot;tiles.outgoing.literal&quot;;
    this.fn = function (triples, transport, cb) {
        var draft = [];
        transport.get_concept(&quot;outgoing.Literal&quot;, function (literal) {
            if (literal) {
                while (literal.length &gt; 0) {
                    var index = literal.pop();
                    var triple = triples[index];
                    draft.push({direction: &quot;out&quot;, triple: triple});
                }
            }
            cb(draft);
        });
    };

};

Detripler.prototype = Object.create(Base_detripler.prototype);
Detripler.prototype.constructor = Detripler;

module.exports = Detripler;
},{&quot;../../const/css&quot;:2,&quot;../../templating&quot;:47,&quot;../scheme&quot;:22}],15:[function(require,module,exports){
var templating = require(&quot;../../templating&quot;), Base_detripler = require(&quot;../scheme&quot;), CSS = require(&quot;../../const/css&quot;);

var ID = &quot;outgoing.named&quot;;

var Detripler = function () {
    Base_detripler.call(this, ID);
    this.worker = true;
    this.template_id = &quot;tiles.outgoing.named&quot;;
    this.fn = function (triples, transport, cb) {
        var draft = [];
        transport.get_concept(&quot;outgoing.NamedNode&quot;, function (named) {
            if (named) {
                while (named.length &gt; 0) {
                    var index = named.pop();
                    var triple = triples[index];
                    draft.push({direction: &quot;out&quot;, triple: triple});
                }
            }
            cb(draft);
        });
    };
};

Detripler.prototype = Object.create(Base_detripler.prototype);
Detripler.prototype.constructor = Detripler;

module.exports = Detripler;
},{&quot;../../const/css&quot;:2,&quot;../../templating&quot;:47,&quot;../scheme&quot;:22}],16:[function(require,module,exports){
var detriplers = {};

var add = function (c) {
    for (var i = 0; i &lt; c.length; i++) {
        var Detripler = c[i];
        var d = new Detripler();
        detriplers[d.id] = d;
    }
};

var constructors = [
    require(&quot;./detripler/outgoing.blank&quot;),
    require(&quot;./detripler/outgoing.named&quot;),
    require(&quot;./detripler/outgoing.literal&quot;)
];

add(constructors);

module.exports = detriplers;
},{&quot;./detripler/outgoing.blank&quot;:13,&quot;./detripler/outgoing.literal&quot;:14,&quot;./detripler/outgoing.named&quot;:15}],17:[function(require,module,exports){
/**
 * Worker
 **/

var stringify = function (obj) {
    return JSON.stringify(obj, function (k, v) {
        if (typeof v == &quot;function&quot;) {
            return v.toString();
        } else {
            return v;
        }
    });
};

// Transport object
var Local_interaction_interface = function(run) {
    this.run = run;
};

Local_interaction_interface.prototype.get_draft = function (id, cb) {
    cb(this.run.get_draft(id).slice());
};

Local_interaction_interface.prototype.get_concept = function (id, cb) {
    cb(this.run.get_concept(id).slice());
};

Local_interaction_interface.prototype.set_draft = function (id, draft, cb) {
    cb(this.run.modify_draft(id, draft));
};

var Internal = function () {
    this.state = &quot;free&quot;;
    this.fns = {};
};

Internal.prototype.learn = function (id ,fn) {
    // Todo learn
    this.fns[id] = fn;
};

Internal.prototype.run = function (id, run, cb) {
    if (this.state == &quot;free&quot;) {
        this.state = &quot;occupied&quot;;
        this.fns[id](run.triples, new Local_interaction_interface(run), function(results) {
            cb(results);
        });
    }
};

Internal.prototype.knows = function (id) {
    return this.fns.hasOwnProperty(id);
};

Internal.prototype.get_state = function () {
    return this.state;
};

module.exports = Internal;
},{}],18:[function(require,module,exports){
(function (global){
/**
 * Singleton worker group creation. Needs to be set once.
 **/

var $ = (typeof window !== &quot;undefined&quot; ? window[&#x27;$&#x27;] : typeof global !== &quot;undefined&quot; ? global[&#x27;$&#x27;] : null), plugin_name = require(&quot;../../const/general_plugin.js&quot;).name, W = require(&quot;./worker&quot;), Internal = require(&quot;./internal&quot;);
var log = require(&quot;../../logger&quot;)(&quot;Job_dist&quot;);

var defaults = {
    n_cores: -1,
    worker_path: &quot;./&quot;,
    concepts: function () {

    }
};

var Job_distributer = function (opt) {
    this._opt = $.extend(true, {}, defaults, opt);
    var _n_cores = (this._opt.n_cores &lt;= 0) ? navigator.hardwareConcurrency - 1 : this._opt.n_cores;
    if (!_n_cores)
        _n_cores = 0;

    this.workers = [];
    for (var i = 0; i &lt; _n_cores; i++) {
        this.workers.push(new W(this._opt.worker_path + plugin_name + &quot;_worker.js&quot;)); // New worker here
    }

    this.internal = new Internal();
};

Job_distributer.prototype.learn = function (id, fn, worker) {
    if (!this.internal.knows(id)) {
        if (worker) {
            for (var i = 0; i &lt; this.workers.length; i++) {
                this.workers[i].learn(id, fn);
            }
        }
        this.internal.learn(id, fn)
    }
};

Job_distributer.prototype.distribute_run = function (run, cb) {
    var that = this;
    run.on(&quot;done&quot;, function () {
        if (!run.cleaned) {
            run.cleaned = true;
            for (var j = 0; j &lt; that.workers.length; j++) {
                that.workers[j].clear_data_of(run.id);
            }
        }
        log(&quot;Detripling done.&quot;)
        if (cb)
            cb(run);
    });
    if (run.triples) {

        // start detripling process
        this._distribute_run_help(run, null);
    }
};

Job_distributer.prototype._distribute_run_help = function (run) {
    var that = this;
    if (!run.is_done()) {

        // On main
        if (this.internal.get_state() == &quot;free&quot;) {
            var detripler = run.get_next_detripler(false);
            if (detripler) {
                this.internal.run(detripler.id, run, function (r, t, i, d) {
                    return function (result) {
                        i.state = &quot;free&quot;;
                        r.set_draft(d, result);
                        t._distribute_run_help(r);
                    }
                }(run, that, this.internal, detripler))
            }
        }

        // On worker
        for (var i = 0; i &lt; this.workers.length; i++) {
            if (this.workers[i].get_state() == &quot;free&quot;) {
                var w_detripler = run.get_next_detripler(true);
                if (w_detripler) {
                    var do_on_worker = function (r, t, w, d) {
                        return function () {
                            w.run(d.id,
                                r,
                                function (result) {
                                    w.state = &quot;free&quot;;
                                    r.set_draft(d, result);
                                    t._distribute_run_help(r);
                                });
                        }
                    }(run, that, this.workers[i], w_detripler);

                    if (!this.workers[i].has_triples_for(run)) {
                        this.workers[i].set_triples_for(run, do_on_worker);
                    } else {
                        do_on_worker();
                    }
                }
            }
        }
    }
};

Job_distributer.prototype.destroy = function (cb) {
    for (var i = 0; i &lt; this.workers.length; i++) {
        this.workers[i].terminate();
    }
    this.internal = null;
};

var instance = null;

module.exports = {
    get: function () {
        if (!instance)
            instance = new Job_distributer();
        return instance;
    },
    set: function (opt) {
        if (instance)
            instance.destroy();
        instance = new Job_distributer(opt);
    }
};
}).call(this,typeof global !== &quot;undefined&quot; ? global : typeof self !== &quot;undefined&quot; ? self : typeof window !== &quot;undefined&quot; ? window : {})
},{&quot;../../const/general_plugin.js&quot;:3,&quot;../../logger&quot;:37,&quot;./internal&quot;:17,&quot;./worker&quot;:19}],19:[function(require,module,exports){
/**
 * Worker
 **/
var e_ext = require(&quot;../../util/event_obj_extender&quot;);

var stringify = function (obj) {
    return JSON.stringify(obj, function (k, v) {
        if (typeof v == &quot;function&quot;) {
            return v.toString();
        } else {
            return v;
        }
    });
};

var worker_run_id_counter = 0;

var Worker_wrap = function (path) {
    this.state = &quot;free&quot;;
    this.worker = new Worker(path);
    this.triple_history = {};
    return e_ext(this);
};

Worker_wrap.prototype.set_triples_for = function (run, cb) {
    this.triple_history[run.id] = true;
    this.worker.postMessage({cmd: &#x27;set&#x27;, run_id: run.id, triples: stringify(run.triples)});
    if (cb)
        cb();
};

Worker_wrap.prototype.learn = function (fn_id, fn) {
    this.worker.postMessage({cmd: &#x27;learn&#x27;, fn_id: fn_id, fn: stringify(fn)});
};

Worker_wrap.prototype.run = function (fn_id, run, cb) {
    if (this.state == &quot;free&quot;) {
        this.state = &quot;occupied&quot;;
        var worker_run_id = worker_run_id_counter++;
        var that = this;
        this.worker.addEventListener(&#x27;message&#x27;, function (w_r_id, r) {
            return function (e) {
                if (e.data.worker_run_id == w_r_id) {
                    switch (e.data.cmd) {
                        case &quot;get_concept&quot;:
                            that.worker.postMessage({cmd: &#x27;concept&#x27;, concept: r.get_concept(e.data.concept_id)});
                            break;
                        case &quot;get_draft&quot;:
                            that.worker.postMessage({cmd: &#x27;draft&#x27;, draft: r.get_draft(e.data.detripler_id)});
                            break;
                        case &quot;set_draft&quot;:
                            that.worker.postMessage({cmd: &#x27;draft_set&#x27;, draft: r.modify_draft(e.data.detripler_id, e.data.draft)});
                            break;
                        case &quot;done&quot;:
                            var parsed_results = e.data.results ? e.data.results : null;
                            cb(parsed_results);
                            that.worker.removeEventListener(this);
                            break;
                        default:
                            break;
                    }
                }
            }
        }(worker_run_id, run));
        this.worker.postMessage({cmd: &#x27;run&#x27;, fn_id: fn_id, run_id: run.id, worker_run_id: worker_run_id});
    }
};

Worker_wrap.prototype.get_state = function () {
    return this.state;
};

Worker_wrap.prototype.has_triples_for = function (run) {
    return this.triple_history.hasOwnProperty(run.id);
};

Worker_wrap.prototype.clear_data_of = function (run) {
    this.worker.postMessage({cmd: &#x27;clear&#x27;, run_id: run.id});
    delete this.triple_history[run.id];
};

module.exports = Worker_wrap;
},{&quot;../../util/event_obj_extender&quot;:48}],20:[function(require,module,exports){
var log = require(&quot;./../logger&quot;)(&quot;Detripler_manager&quot;), Structure = require(&quot;./structure&quot;), Jobs = require(&quot;./jobs/jobs&quot;), Run = require(&quot;./run&quot;);
var detriplers = require(&quot;./detriplers.js&quot;), Base_detripler = require(&quot;./scheme&quot;);

var defaults = {
    detriplers: detriplers
    //jobs: {}
};

var Manager = function (opt) {
    this._opt = $.extend(true, {}, defaults, opt);
    if (this._opt.jobs)
        Jobs.set(this._opt.jobs);
    this.jobs = Jobs.get();
    var keys = Object.keys(this._opt.detriplers);
    for (var i = 0; i &lt; keys.length; i++) {
        var detripler = this._opt.detriplers[keys[i]];
        if (!detripler.derived_from_base) {
            detripler = this._opt.detriplers[keys[i]] = $.extend(true, new Base_detripler(keys[i]), detripler);
        }
        this.jobs.learn(detripler.id, detripler.fn, detripler.worker);
    }
    this.structure = new Structure(this._opt.detriplers);
};

Manager.prototype.detriple = function (triples, concepts, structure, cb) {
    if (!structure)
        structure = this.structure;
    var run = new Run(triples, concepts, structure), that = this;
    this.jobs.distribute_run(run, cb);
    return run;
};

Manager.prototype.get_detriplers = function () {
    return this._opt.detriplers;
};

module.exports = Manager;
},{&quot;./../logger&quot;:37,&quot;./detriplers.js&quot;:16,&quot;./jobs/jobs&quot;:18,&quot;./run&quot;:21,&quot;./scheme&quot;:22,&quot;./structure&quot;:23}],21:[function(require,module,exports){
var log = require(&quot;./../logger&quot;)(&quot;Detripler_run&quot;), e_ext = require(&quot;../util/event_obj_extender&quot;);

var run_id_counter = 0;

var Detripling_run = function (triples, concepts, structure) {
    this.triples = triples;
    this.concepts = concepts;
    this.structure = structure;
    this.id = run_id_counter++;
    this.d_keys = structure.d_keys.slice();
    this._detripler_done_history = {&quot;_&quot;: true};
    this.results = {};
    return e_ext(this);
};

Detripling_run.prototype.get_next_detripler = function (worker_flag) {
    var next = null;
    for (var n = 0; (n &lt; this.d_keys.length) &amp;&amp; (next == null); n++) {
        var t = this.structure.cy.$(&quot;#&quot; + this.d_keys[n]), parents_ready = true, parents = t.incomers(&quot;node&quot;);
        for (var j = 0; ((j &lt; parents.length) &amp;&amp; parents_ready); j++) {
            var p_id = parents[j].id();
            if (this._detripler_done_history[p_id] == undefined) {
                parents_ready = false;
            }
        }

        // Only get fitting detripler. Does it need to be computable on workers? Are the parents done?
        if (parents_ready &amp;&amp; (!worker_flag || this.structure.detriplers[this.d_keys[n]].worker)) {
            next = this.d_keys[n];
            this.d_keys.splice(n, 1);
        }
    }
    return this.structure.detriplers[next];
};

Detripling_run.prototype.set_draft = function (detripler, draft) {
    this.results[detripler.id] = draft;
    this._detripler_done_history[detripler.id] = true;
    if(this.is_done()) {
        this.trigger(&quot;done&quot;);
    }
};

Detripling_run.prototype.modify_draft = function (id, draft) {
    this.results[id] = draft;
    this._detripler_done_history[id] = true;
    if(this.is_done()) {
        this.trigger(&quot;done&quot;);
    }
};

Detripling_run.prototype.get_draft = function (id) {
    if (this.results[id]) {
        return this.results[id];
    } else {
        log(&quot;No draft for &quot; + id + &quot; found.&quot;);
        return null;
    }
};

Detripling_run.prototype.get_concept = function (id) {
    if (this.concepts[id]) {
        return this.concepts[id];
    } else {
        log(&quot;No concept for &quot; + id + &quot; found.&quot;);
        return [];
    }
};

Detripling_run.prototype.is_done = function () {
    return Object.keys(this._detripler_done_history).length == this.structure.d_keys.length + 1;
};

module.exports = Detripling_run;
},{&quot;../util/event_obj_extender&quot;:48,&quot;./../logger&quot;:37}],22:[function(require,module,exports){
(function (global){
var templating = require(&quot;../templating&quot;), CSS = require(&quot;../const/css&quot;), Handlebars = (typeof window !== &quot;undefined&quot; ? window[&#x27;Handlebars&#x27;] : typeof global !== &quot;undefined&quot; ? global[&#x27;Handlebars&#x27;] : null);

var Detripler = function (id) {
    this.derived_from_base = true;
    this.id = id;
    this.parents = [];
    this.fn = function (triples, transport, cb) {
        console.log(&quot;Base function called for &quot; + triples);
        cb(triples);
    };
    // Use template by id
    // OR ..
    this.template_id = &quot;tiles.default&quot;;
    // .. use this templating function
    this.templating_fn = function (draft, triples) {
        var divs = [], template;
        if (this.template) {
            if (this.compiled_template) {
                template = this.compiled_template;
            } else {
                this.compiled_template = Handlebars.compile(this.template);
                template = Handlebars.compile(this.template);
            }
        } else {
            if (this.template_id) {
                template = templating[this.template_id];
            } else {
                template = templating[&quot;tiles.default&quot;];
            }
        }
        if (draft) {
            for (var i = 0; i &lt; draft.length; i++) {
                var div = $(template({CSS: CSS, data: {draft: draft[i], detripler: this}}));
                div.data(&quot;draft_data&quot;, draft[i]);
                div.data(&quot;post_view_cbs&quot;, []);
                div.data(&quot;type&quot;, this.id);
                divs.push(div);
            }
        }
        return divs;
    };
    this.worker = true;
};

module.exports = Detripler;
}).call(this,typeof global !== &quot;undefined&quot; ? global : typeof self !== &quot;undefined&quot; ? self : typeof window !== &quot;undefined&quot; ? window : {})
},{&quot;../const/css&quot;:2,&quot;../templating&quot;:47}],23:[function(require,module,exports){
(function (global){
var log = require(&quot;./../logger&quot;)(&quot;Detripler_structure&quot;), cytoscape = (typeof window !== &quot;undefined&quot; ? window[&#x27;cytoscape&#x27;] : typeof global !== &quot;undefined&quot; ? global[&#x27;cytoscape&#x27;] : null);

var Structure = function (detriplers) {

    this.detriplers = detriplers;

    // Relation graph of detriplers
    this._rendered_graph = $(&quot;&lt;div style=&#x27;height: 100%; width: 100%&#x27;&gt;&lt;div style=&#x27;height: 100%; width: 100%&#x27;&gt;&lt;/div&gt;&lt;/div&gt;&quot;);
    this.cy = cytoscape({
        container: this._rendered_graph.children()[0],
        layout: {
            name: &#x27;breadthfirst&#x27;,
            directed: true
        },
        style: [
            {
                selector: &#x27;node&#x27;,
                style: {
                    &#x27;background-color&#x27;: &#x27;red&#x27;,
                    &#x27;content&#x27;: &#x27;data(id)&#x27;
                }
            }
        ]
    });
    this.cy.add({group: &quot;nodes&quot;, data: {id: &quot;_&quot;}});
    this.d_keys = Object.keys(detriplers);
    for (var i = 0; i &lt; this.d_keys.length; i++) {
        this._insert_in_graph(detriplers[this.d_keys[i]]);
    }
};

Structure.prototype.add_detripler = function (detripler) {
    if (!this.detriplers[detripler.id])
        this.detriplers[detripler.id] = detripler;
    this.d_keys.push(detripler.id);
    this._insert_parent_in_graph(detripler);
};

Structure.prototype._insert_in_graph = function (detripler) {
    var cy_data = [];
    if (!detripler.parents.length &gt; 0)
        cy_data.push({
            group: &quot;edges&quot;,
            data: {id: &quot;_&quot; + detripler.id, label: detripler.id, source: &quot;_&quot;, target: detripler.id}
        });
    for (var i = 0; i &lt; detripler.parents.length; i++) {
        var pre_detripler = this.detriplers[detripler.parents[i]];
        var e_id = pre_detripler.id + &quot;:&quot; + detripler.id;
        cy_data.push({group: &quot;edges&quot;, data: {id: e_id, source: pre_detripler.id, target: detripler.id}});
    }
    cy_data.push({group: &quot;nodes&quot;, data: {id: detripler.id}});
    this.cy.add(cy_data);
};

Structure.prototype.paint_dependencies_on = function (ele) {
    this._rendered_graph.detach();
    $(ele).append(this._rendered_graph);
    this.cy.resize();
    this.cy.fit();
};

//Structure.prototype.get_schedule = function () {
//    var done_nodes = {&quot;_&quot;: -1}, detriplers = this.d_keys.slice(), len = detriplers.length;
//
//    if (this.schedule &amp;&amp; this.d_keys.length == this.schedule_elements_number)
//        return this.schedule;
//
//    // ASAP algorithm
//    do {
//        for (var n = 0; n &lt; detriplers.length; n++) {
//            var t = this.cy.$(&quot;#&quot; + detriplers[n]), parents_ready = true, schedule_on = -1, parents = t.incomers(&quot;node&quot;);
//            for (var j = 0; ((j &lt; parents.length) &amp;&amp; parents_ready); j++) {
//                var p_id = parents[j].id();
//                if (done_nodes[p_id] == undefined) {
//                    parents_ready = false;
//                } else {
//                    schedule_on = Math.max(schedule_on, done_nodes[p_id])
//                }
//            }
//            if (parents_ready) {
//                done_nodes[t.id()] = schedule_on + 1;
//                detriplers.splice(n, 1);
//            }
//        }
//        if (detriplers.length == len) {
//            if (len == 0)
//                break;
//            log(&quot;Error in detripler dependencies.&quot;);
//            break;
//        } else {
//            len = detriplers.length;
//        }
//    } while (true);
//
//    // Write schedule
//    var schedule = [];
//    for (var i = 0; i &lt; this.d_keys.length; i++) {
//        if (!schedule[done_nodes[this.d_keys[i]]])
//            schedule[done_nodes[this.d_keys[i]]] = [];
//        schedule[done_nodes[this.d_keys[i]]].push(this.d_keys[i]);
//    }
//    this.schedule_levels = done_nodes;
//    this.schedule_elements_number = this.d_keys.length;
//    this.schedule = schedule;
//    return schedule;
//};

module.exports = Structure;
}).call(this,typeof global !== &quot;undefined&quot; ? global : typeof self !== &quot;undefined&quot; ? self : typeof window !== &quot;undefined&quot; ? window : {})
},{&quot;./../logger&quot;:37}],24:[function(require,module,exports){
(function (global){
var cytoscape = (typeof window !== &quot;undefined&quot; ? window[&#x27;cytoscape&#x27;] : typeof global !== &quot;undefined&quot; ? global[&#x27;cytoscape&#x27;] : null), CSS = require(&quot;./const/css&quot;), templating = require(&quot;./templating&quot;), log = require(&quot;./logger.js&quot;)(&quot;History&quot;);
var Layer_factory = require(&quot;./layers/factory&quot;);

var History = function (synopsis, opt) {
    this._$history = $(templating[&#x27;history&#x27;]({CSS: CSS}));
    this._synopsis = synopsis;
    synopsis._$ele.append(this._$history);
    this._layer_data = {};
    this._add_history = [];
    this._current_add_history_index = 0;
};

History.prototype.add = function (layer) {
    if (this._ignore_next_add) {
        delete this._ignore_next_add;
    } else {
        this._add_history.push(layer.id);
        this._current_add_history_index++;
        if (!this._layer_data.hasOwnProperty(layer.id)) {
            this._layer_data[layer.id] = {make_arguments: layer.make_arguments, post_view_cbs: layer.post_view_cbs};
        }
    }
};

History.prototype.back = function (cb) {
    if (this._add_history.length &gt; 1) {
        this._ignore_next_add = true;
        this._add_history.pop();
        var uri = this._add_history[this._add_history.length - 1];
        var layer = Layer_factory.make.apply(Layer_factory, this._layer_data[uri].make_arguments);
        layer.post_view_cbs = this._layer_data[uri].post_view_cbs;
        this._synopsis.show(layer, function (view) {
            // Get callback functions to call after showing layer
            for (var i = 0, ilen = view.layer.post_view_cbs.length; i &lt; ilen; i++) {
                view.layer.post_view_cbs[i].apply(null, arguments);
            }
            if (cb)
                cb.apply(null, arguments);
        });
    } else {
        this._add_history = [];
        this._synopsis.overlay_manager.destroy_all();
    }
};

History.prototype.show = function () {
    log(&quot;show&quot;)
};

module.exports = History;
}).call(this,typeof global !== &quot;undefined&quot; ? global : typeof self !== &quot;undefined&quot; ? self : typeof window !== &quot;undefined&quot; ? window : {})
},{&quot;./const/css&quot;:2,&quot;./layers/factory&quot;:30,&quot;./logger.js&quot;:37,&quot;./templating&quot;:47}],25:[function(require,module,exports){
var CSS = require(&quot;./../const/css.js&quot;), templating = require(&#x27;./../templating.js&#x27;);

var Nav = function (fn, l, ele, c) {
    this._$html = $(templating[&quot;components.nav&quot;]({CSS: CSS, class_in: c, label: l}));
    this._fn = fn;
    this._$html.on(&quot;click&quot;, this._fn);
    if (ele)
        ele.append(this._$html);
};

Nav.prototype.toggle_disable = function () {
    this._$html.toggleClass(CSS.disabled);
    if (this._$html.hasClass(CSS.disabled)) {
        this._$html.off(&quot;click&quot;, this._fn);
    } else {
        this._$html.on(&quot;click&quot;, this._fn)
    }
};

module.exports = Nav;
},{&quot;./../const/css.js&quot;:2,&quot;./../templating.js&quot;:47}],26:[function(require,module,exports){
var MutationObserver = window.MutationObserver || window.WebKitMutationObserver;
var CSS = require(&quot;./../const/css.js&quot;), templating = require(&#x27;./../templating.js&#x27;), e_ext = require(&quot;../util/event_obj_extender&quot;);

var Scroll = function (ele) {
    this._$html = ele;
    this._$html.addClass(CSS.scroll_box);
    this._$content = $(templating[&quot;components.scroll&quot;]({CSS: CSS}));
    if (ele)
        ele.append(this._$content);
    var that = this;

    // Load if bottom of scroll is reached
    this._$html.scroll(function () {
        if ((that._$html.scrollTop() + that._$html.height() &gt;= that._$content.outerHeight() - 5)) {
            that.add_row();
        }
    }.debounce(10));
    return e_ext(this);
};

Scroll.prototype.get_content_container = function () {
    return this._$content;
};

Scroll.prototype.add_row = function (cb) {
    var that = this;
    // Load after modification if we got more space
    this._observer = new MutationObserver(function (c) {
        return function (m, observer) {
            if (observer._start_height &gt;= that._$content.height()) {
                // Timeout to make sure height was updated before adding next
                setTimeout(function(){that.trigger(&quot;get_more&quot;);}, 0);
            } else {
                if (observer._start_height == 0) {
                    observer._start_height = that._$content.height();
                    that.trigger(&quot;get_more&quot;);
                } else {
                    observer.disconnect();
                    if (c)
                        c();
                }
            }
        }
    }(cb));
    this._observer._start_height = this._$content.height();
    this._observer.observe(this._$content[0], {
        childList: true,
        subtree: false,
        attributes: false
    });
    that.trigger(&quot;get_more&quot;);
};

Scroll.prototype.fill_until_scrollbar = function () {
    var that = this;
    if (!this.has_scroll_bar()) {
        this.add_row(function () {
            that.fill_until_scrollbar();
        });
    }
};

Scroll.prototype.append = function (ele, cb) {
    this._$content.append(ele);
    if(cb)
        cb(ele)
};

Scroll.prototype.has_scroll_bar = function () {
    return this._$content.height() &gt; this._$html.height() + 5;
};

Scroll.prototype.clear = function (callback) {
    this._$content.children().detach();
    if (callback)
        callback();
};

// Function to call if there is no more to add
Scroll.prototype.disable_observer = function () {
    this._observer.disconnect();
};

module.exports = Scroll;
},{&quot;../util/event_obj_extender&quot;:48,&quot;./../const/css.js&quot;:2,&quot;./../templating.js&quot;:47}],27:[function(require,module,exports){
(function (global){
/**
 * Singleton info box creation.
 **/

var $ = (typeof window !== &quot;undefined&quot; ? window[&#x27;$&#x27;] : typeof global !== &quot;undefined&quot; ? global[&#x27;$&#x27;] : null), CSS = require(&quot;./const/css.js&quot;), U_layout = require(&quot;./util/layout.js&quot;);

var START_FADEOUT = 3000;

var Info = function () {
    this.timeout = null;
    this.unappended = true;
    this.$info = $(&quot;&lt;div class=&quot; + CSS.monolog + &quot;&gt;&lt;/div&gt;&quot;);
    var that = this;
    this._start_timer = function () {
        clearTimeout(that.timeout);
        that.timeout = setTimeout(function () {
            that.hide();
        }, START_FADEOUT);
    };
    this.$info.click(function () {
        clearTimeout(that.timeout);
        that.$info.removeClass(CSS.fadeIn);
    });
};

Info.prototype.append_to = function (ele) {
    $(ele).append(this.$info);
    this.unappended = false;
};

Info.prototype._add_message = function (msg) {
    var span = $(&quot;&lt;span style=&#x27;height: 40px&#x27;&gt;&quot; + msg + &quot;&lt;/span&gt;&quot;), children = this.$info.children();
    if (U_layout.getTransitionSupport()) {
        switch (children.size()) {
            case 0:
                span.css(&quot;bottom&quot;, &quot;-80px&quot;);
                this.$info.append(span);
                setTimeout(function () {
                    span.css(&quot;bottom&quot;, &quot;0px&quot;);
                }, 0);
                break;
            case 1:
                span.css(&quot;bottom&quot;, &quot;-40px&quot;);
                this.$info.append(span);
                setTimeout(function () {
                    span.css(&quot;bottom&quot;, &quot;0px&quot;);
                }, 0);
                break;
            default:
                while (this.$info.children().size() &gt;= 2) {
                    children.first().remove();
                }
                span.css(&quot;bottom&quot;, &quot;-40px&quot;);
                this.$info.append(span);
                setTimeout(function () {
                    span.css(&quot;bottom&quot;, &quot;0px&quot;);
                }, 0);
                break;
        }
    } else {
        switch (children.size()) {
            case 0:
            case 1:
                this.$info.append(span);
                break;
            default:
                while (this.$info.children().size() &gt;= 2) {
                    children.first().remove();
                }
                this.$info.append(span);
                break;
        }
    }
};


Info.prototype.show = function (msg) {
    clearTimeout(this.timeout);
    var that = this;
    if (msg) {
        setTimeout(function () {
            that._add_message(msg);
            that._start_timer(that);
        }, 500);
    }
    setTimeout(function () {
        that.$info.addClass(CSS.fadeIn);
    }, 50);
};

Info.prototype.hide = function () {
    this.$info.removeClass(CSS.fadeIn);
};

var instance = new Info();

module.exports = instance;
}).call(this,typeof global !== &quot;undefined&quot; ? global : typeof self !== &quot;undefined&quot; ? self : typeof window !== &quot;undefined&quot; ? window : {})
},{&quot;./const/css.js&quot;:2,&quot;./util/layout.js&quot;:49}],28:[function(require,module,exports){
module.exports={
  &quot;filter&quot; : &quot;Filtern: &quot;,
  &quot;sorter&quot; : &quot;Sortieren: &quot;
}
},{}],29:[function(require,module,exports){
module.exports={
  &quot;filter&quot; : &quot;Filter&quot;,
  &quot;sorter&quot; : &quot;Sort: &quot;,
  &quot;sorter_default&quot; : &quot;by ...&quot;,
  &quot;back&quot; : &quot;back&quot;,
  &quot;history&quot; : &quot;history&quot;,
  &quot;close&quot; : &quot;close&quot;,
  &quot;sort.alphabet&quot; : &quot;alphabetically&quot;,
  &quot;sort.random&quot; : &quot;random&quot;,
  &quot;sort.weight&quot; : &quot;tile type&quot;,
  &quot;filter.in&quot; : &quot;only subjects&quot;,
  &quot;filter.out&quot; : &quot;only objects&quot;,
  &quot;filter_options&quot; : &quot;+ condition&quot;,
  &quot;stop_remote&quot;: &quot;stop remote loading&quot;,
  &quot;more&quot;: &quot;more&quot;,
  &quot;n_tiles&quot;: &quot;tiles&quot;,
  &quot;and&quot;: &quot;and&quot;,
  &quot;empty&quot;: &quot;No data&quot;,
  &quot;no_browse&quot;: &quot;Browsing for this tile type disabled. Type: &quot;
}
},{}],30:[function(require,module,exports){
/**
 * Layer factory
 **/

var Util = require(&quot;./../util/misc&quot;), log = require(&quot;./../logger.js&quot;)(&quot;LayerFactory&quot;), event_obj_extender = require(&#x27;../util/event_obj_extender&#x27;);
var store = require(&#x27;../store&#x27;).get();

var Factory = {};

// Object to hold layer types
Factory.layer_types = {};

Factory.addLayerTypes = function (constructors) {
    var keys = Object.keys(constructors);
    for (var i = 0; i &lt; keys.length; i++) {
        var type = keys[i];
        var Layer = constructors[type];
        Factory.layer_types[type] = Layer;
        Layer.prototype.type = type;
    }
};

var constructors = {
    Query: require(&#x27;./types/query_layer&#x27;),
    Pattern: require(&#x27;./types/pattern_layer&#x27;),
    Out: require(&#x27;./types/out_layer&#x27;),
    Item: require(&#x27;./types/out_layer&#x27;),
    NamedNode: require(&#x27;./types/out_layer&#x27;)
};

Factory.addLayerTypes(constructors);

Factory.make = function (synopsis, input, type) {
    if (!type)
        if (input.interfaceName) {
            type = input.interfaceName;
        } else {
            log(&quot;Factory couldn&#x27;t extract input type.&quot;);
            return null;
        }
    if (this.layer_types[type]) {
        var layer = new this.layer_types[type](synopsis.detriple_manager, synopsis.decorator_manager, synopsis.msg, input);

        // Remote loading
        layer.on(&quot;request_remote&quot;, function (plugin, l) {
                return function (querys, cb, fail) {
                    var num_of_remote_requests = plugin.get_remote_count() * querys.length;
                    for (var i = 0; i &lt; querys.length; i++) {
                        var bar = plugin.progress.make_n_add_bar(l.label + &quot;_&quot; + (i + 1), plugin.get_remote_count());
                        bar.do_partial_progress(0);

                        // Define an interrupt flag
                        var flag = event_obj_extender({});
                        flag.interrupt = false;

                        // Stop the progress bar on destroyed layer
                        var on_destroy_stop = function (b, fl) {
                            return function () {
                                fl.interrupt = true;
                                fl.trigger(&quot;interrupt&quot;);
                                b.do_stop();
                            };
                        }(bar, flag);
                        l.once(&quot;destroyed&quot;, on_destroy_stop);

                        // Stop listening for &quot;destroyed&quot; on layer if the bar is done. Progress stopping isn&#x27;t needed anymore.
                        bar.once(&quot;done&quot;, function (_l, _on_destroy_stop) {
                            return function () {
                                _l.off(&quot;destroyed&quot;, _on_destroy_stop);
                            }
                        }(l, on_destroy_stop));

                        // Only execute on remote of layer is still alive
                        if (!flag.interrupt) {
                            plugin.execute_on_remote_with_limits(querys[i], 0, flag,

                                // On success of a remote execution try to work with the result set
                                function (b, fl) {
                                    return function (resp, remote_num, partial) {
                                        log(&quot;Got &quot; + resp.results.bindings.length + &quot; triples from remote query &quot; + querys[i]);

                                        // Only trigger callback if layer is still alive
                                        if (!fl.interrupt) {
                                            b.do_partial_progress(remote_num);
                                            if (cb)
                                                cb(resp, b, remote_num, partial);
                                        }
                                    }
                                }(bar, flag),

                                // On fail of a remote execution add warning effect to progress bar and do a partial progress
                                function (b) {
                                    return function (e, remote_num) {
                                        b.do_warn(remote_num);
                                        b.do_progress(remote_num);
                                        if (fail)
                                            fail(e);
                                    }
                                }(bar));
                        }
                    }
                    if (querys.length &gt; 0)
                        plugin.progress.show();
                }
            }(synopsis, layer)
        );
        layer.make_arguments = arguments;
        return layer;
    }
    else {
        log(&quot;Layer type &quot; + type + &quot; not defined.&quot;);
        return null;
    }
}
;

module.exports = Factory;

require(&quot;./layer&quot;);
},{&quot;../store&quot;:44,&quot;../util/event_obj_extender&quot;:48,&quot;./../logger.js&quot;:37,&quot;./../util/misc&quot;:50,&quot;./layer&quot;:31,&quot;./types/out_layer&quot;:33,&quot;./types/pattern_layer&quot;:34,&quot;./types/query_layer&quot;:35}],31:[function(require,module,exports){
/**
 * Layer
 **/

var CSS = require(&quot;../const/css&quot;), templating = require(&quot;../templating&quot;), log = require(&quot;../logger.js&quot;)(&quot;Layer&quot;);
var factory = require(&#x27;./factory&#x27;), info = require(&#x27;../info&#x27;), Layout_engine_flex = require(&quot;../layout_engines/flexbox&quot;);
var Nav = require(&#x27;../html_obj/nav&#x27;), e_ext = require(&quot;../util/event_obj_extender&quot;), Triple_set = require(&quot;./triple_set&quot;);
var Scroll = require(&#x27;../html_obj/scroll&#x27;), Util = require(&quot;../util/misc&quot;);
var plugin_name = require(&quot;../const/general_plugin&quot;).name;

var defaults = {
    sorters: [
        {
            label: &quot;alphabet&quot;, fn: function (a, b) {
            var getComp = function (elem) {
                var $elem = $(elem);
                var label = $elem.find(&quot;.&quot; + CSS.label), itemText = label.length ? label
                    : $elem;
                return itemText.text();
            };
            return getComp(a).localeCompare(getComp(b));
        }
        },
        {
            label: &quot;random&quot;, fn: function () {
            return Math.random() &lt; 0.5 ? -1 : 1;
        }
        },
        {
            label: &quot;weight&quot;, fn: function (a, b) {
            var getComp = function (elem) {
                var $elem = $(elem);
                var weight = $elem.data(&quot;weight&quot;);
                if (!((typeof weight === &quot;undefined&quot;) || (weight === null))) {
                    return -1 * weight;
                } else {
                    return 0;
                }
            };
            return getComp(a) - getComp(b);
        }
        }
    ],
    filters: [
        {
            label: &quot;in&quot;, priority: 1, fn: function (tile) {
            var data = $(tile).data(&quot;draft_data&quot;);
            if (data &amp;&amp; data.hasOwnProperty(&quot;direction&quot;)) {
                return $(tile).data(&quot;draft_data&quot;).direction == &quot;inc&quot;;
            } else {
                return false;
            }
        }
        },
        {
            label: &quot;out&quot;, priority: 2, fn: function (tile) {
            var data = $(tile).data(&quot;draft_data&quot;);
            if (data &amp;&amp; data.hasOwnProperty(&quot;direction&quot;)) {
                return $(tile).data(&quot;draft_data&quot;).direction == &quot;out&quot;;
            } else {
                return false;
            }
        }
        }
    ],
    language_filter: true,
    filter_delay: 300
};

var Layer = function (detripling, decorating, msg, opt) {
    var that = this;

    // make html if not already defined
    if (!this._$html)
        this._$html = $(templating[&quot;layer&quot;]({CSS: CSS, msg: msg}));

    this._opt = !opt ? defaults : $.extend({}, defaults, opt);
    this._msg = msg;
    this.detripling = detripling;
    this.decorating = decorating;

    this.get_concepts = function (triples) {
        var concepts = {};
        for (var i = 0; i &lt; triples.length; i++) {
            concepts[triples[i].object.interfaceName] = i;
        }
        return concepts;
    };

    this._$layout_container = this._$html.find(&quot;.&quot; + CSS.layout_container);
    this._$layout_footer = this._$html.find(&quot;.&quot; + CSS.layout_footer);
    this.layout_engine = new Layout_engine_flex(new Scroll(this._$layout_container), this._$layout_footer, msg);

    // Sorter
    this._$sort_options = this._$html.find(&quot;.&quot; + CSS.sorter + &quot; .dropdown-menu&quot;);
    this._$sort_dropdown_toggle = this._$html.find(&quot;.&quot; + CSS.sorter + &quot; .dropdown-toggle&quot;);
    for (var i = 0; i &lt; this._opt.sorters.length; i++) {
        new Nav((function (that, fn) {
            return function (e) {
                that._$sort_dropdown_toggle.text(e.toElement.text);
                that.sort(fn);
            }
        })(this, this._opt.sorters[i].fn), this._msg.get(&quot;sort.&quot; + this._opt.sorters[i].label), this._$sort_options);
    }

    // Filter button click
    this._chosen_filters = [];
    var filter_btn = this._$html.find(&quot;.&quot; + CSS.filter_btn);
    filter_btn.on(&quot;click&quot;, (function (that) {
        return function (a, b) {
            that.filter();
        }
    })(this));

    // Filter options creation
    this._$filter_options = this._$html.find(&quot;.&quot; + CSS.filter + &quot; .dropdown-menu&quot;);
    for (var j = 0; j &lt; this._opt.filters.length; j++) {
        new Nav((function (that, fn, label, priority) {
            return function () {
                $(this).find(&quot;a&quot;).toggleClass(&quot;fa fa-check&quot;);
                var index = Util.arrayObjectIndexOf(that._chosen_filters, label, &quot;label&quot;);
                if (index != -1) {
                    that._chosen_filters.splice(index, 1);
                } else {
                    that._chosen_filters.push({fn: fn, label: label, priority: priority});
                    that._chosen_filters.sort(function (a, b) {
                        return a.priority - b.priority
                    });
                }
            }
        })(this, this._opt.filters[j].fn, this._opt.filters[j].label, this._opt.filters[j].priority), this._msg.get(&quot;filter.&quot; + this._opt.filters[j].label), this._$filter_options);
    }

    // Filter text box input
    this._$filter_text_input = this._$html.find(&quot;.&quot; + CSS.filter + &quot; .form-control&quot;);
    that._filter_text_last_value = &quot;&quot;;
    this._$filter_text_input.keyup(function (e) {
        var current_text = $(this).val();
        Util.delay(function(){
            if (that._filter_text_last_value != current_text) {
                that._filter_text_last_value = current_text;
                that.filter();
            }
        }, that._opt.filter_delay );
    });

    // Title labels for the layer
    this.label = &quot;Unknown&quot;;
    this.label_small = &quot;Unknown URI&quot;;
    this.triples = new Triple_set();

    // Window resize event
    $(window).on(&quot;resize&quot;, function () {
        that.layout_engine.add([]);
    }.throttle(100));

    // Extend with events
    return e_ext(this);
};

Layer.prototype.tileify = function (triples) {
    var that = this;
    this.detripling.detriple(triples, this.get_concepts(triples), null, function (run) {
        var drafts = run.results;
        var detriplers = that.detripling.get_detriplers();
        var keys = Object.keys(drafts);
        var tiles = [];
        for (var i = 0; i &lt; keys.length; i++) {
            tiles = tiles.concat(detriplers[keys[i]].templating_fn(drafts[keys[i]], triples));
        }

        // Add event functionality to tiles
        for (var j = 0; j &lt; tiles.length; j++) {
            tiles = e_ext(tiles);
        }
        that.layout_engine.add(that.decorating.decorate(tiles));
    });
};

Layer.prototype.set_color = function (color) {
    this._$layout_footer.css(&quot;background-color&quot;, color);
};

Layer.prototype.get_html = function () {
    return this._$html;
};

Layer.prototype.sort = function (fn) {
    this.layout_engine.sort(fn);
};

Layer.prototype.filter = function (filter_string) {
    var filter_functions = [];
    for (var i = 0; i &lt; this._chosen_filters.length; i++) {
        filter_functions.push(this._chosen_filters[i].fn)
    }

    var search_text = this._$filter_text_input.val();
    if (search_text != &quot;&quot;) {
        filter_functions.push(function (text) {
            return function (div) {
                var sel = &quot;div:containsInsensitive(&#x27;&quot; + text + &quot;&#x27;)&quot;;
                var array = div.find(sel);
                return (typeof array !== &#x27;undefined&#x27; &amp;&amp; array.length &gt; 0);
            }
        }(search_text));
    }
    this.layout_engine.filter(filter_functions);
};

Layer.prototype.show_on = function (ele) {
    if (ele.data(plugin_name + &quot;_layer&quot;))
        ele.data(plugin_name + &quot;_layer&quot;).destroy();
    ele.data(plugin_name + &quot;_layer&quot;, this);
    ele.append(this.get_html());
};

Layer.prototype.load_remote = function () {
    // Implement in deriving layers
};

Layer.prototype.load_local = function () {
    // Implement in deriving layers
};

Layer.prototype.destroy = function () {
    var that = this;
    $(window).off(&quot;resize&quot;, function () {
        that.layout_engine.add([]);
    }.throttle(100));
    that.trigger(&quot;destroyed&quot;);
    that._$html.remove();
};

Layer.prototype.reload = function () {
    this.triples.clear();
    this.layout_engine.clear();
    this.load_local();
    this.load_remote();
};

module.exports = Layer;
},{&quot;../const/css&quot;:2,&quot;../const/general_plugin&quot;:3,&quot;../html_obj/nav&quot;:25,&quot;../html_obj/scroll&quot;:26,&quot;../info&quot;:27,&quot;../layout_engines/flexbox&quot;:36,&quot;../logger.js&quot;:37,&quot;../templating&quot;:47,&quot;../util/event_obj_extender&quot;:48,&quot;../util/misc&quot;:50,&quot;./factory&quot;:30,&quot;./triple_set&quot;:32}],32:[function(require,module,exports){
var e_ext = require(&quot;../util/event_obj_extender&quot;);

var Triple_set = function () {
    this.val = [];
    return e_ext(this)
};

Triple_set.prototype.add = function (triple) {
    if (triple instanceof Array) {
        this.val = this.val.concat(triple);
    } else {
        this.val.push(triple);
    }
    this.trigger(&quot;updated&quot;, this.val, triple);
};


Triple_set.prototype.get = function (index) {
    if (!index) {
        return this.val;
    } else {
        return this.val[index];
    }
};

Triple_set.prototype.clear = function (index) {
    this.val = [];
};

module.exports = Triple_set;
},{&quot;../util/event_obj_extender&quot;:48}],33:[function(require,module,exports){
/**
 * Layer used to show the contents of an MICO item.
 **/

var CSS = require(&quot;../../const/css&quot;), store_wrap = require(&quot;../../store&quot;).get(), templating = require(&quot;../../templating&quot;), log = require(&quot;../../logger.js&quot;)(&quot;Layer_query&quot;);
var info = require(&#x27;../../info&#x27;);
var Layer = require(&#x27;../layer&#x27;);
var Query_layer = require(&#x27;../types/query_layer&#x27;);

var Out_layer = function (detripling, decorating, msg, item, opt) {
    this.item = item;
    this._query = &quot;CONSTRUCT { &lt;&quot;+item.nominalValue+&quot;&gt; ?p ?o } WHERE { &lt;&quot;+item.nominalValue+&quot;&gt; ?p ?o}&quot;;
    Query_layer.call(this, detripling, decorating, msg, this._query, opt);
    this.id = item.nominalValue;
    this.label = item.nominalValue;
    this.label_small = &quot;&quot;;

    this.get_concepts = function (triples) {
        var concepts = {};
        for (var i = 0; i &lt; triples.length; i++) {
            if (!concepts[&quot;outgoing.&quot;+triples[i].object.interfaceName]) {
                concepts[&quot;outgoing.&quot;+triples[i].object.interfaceName] = [];
            }
            concepts[&quot;outgoing.&quot;+triples[i].object.interfaceName].push(i);
        }
        return concepts;
    };
};

Out_layer.prototype = Object.create(Layer.prototype);
Out_layer.prototype.constructor = Out_layer;

Out_layer.prototype.load_remote = function () {
    var that = this;
    this.trigger(&quot;request_remote&quot;, [&#x27;SELECT DISTINCT ?s ?p ?o where {?s ?p ?o. VALUES ?s {&lt;&#x27; + this.item.nominalValue + &#x27;&gt;}}&#x27;], function (resp, b, remote_num, partial) {
        var graph = store_wrap.store.parser.parse_to_graph(resp.results.bindings, [&quot;s&quot;, &quot;p&quot;, &quot;o&quot;]);
        that.triples.add(graph.triples);
        if (partial) {
            b.do_partial_progress(remote_num);
        } else {
            b.do_progress(remote_num);
        }
    });
};

module.exports = Out_layer;
},{&quot;../../const/css&quot;:2,&quot;../../info&quot;:27,&quot;../../logger.js&quot;:37,&quot;../../store&quot;:44,&quot;../../templating&quot;:47,&quot;../layer&quot;:31,&quot;../types/query_layer&quot;:35}],34:[function(require,module,exports){
/**
 * Layer
 **/

var CSS = require(&quot;../../const/css&quot;), store_wrap = require(&quot;../../store&quot;).get(), templating = require(&quot;../../templating&quot;), log = require(&quot;../../logger.js&quot;)(&quot;Layer_pattern&quot;);
var info = require(&#x27;../../info&#x27;);
var Layer = require(&#x27;../layer&#x27;);

var Pattern_layer = function (detripling, decorating, msg, patterns, opt) {
    Layer.call(this, detripling, decorating, msg, opt);
    this._patterns = patterns;

    var that = this;
    for (var i = 0; i &lt; this._patterns.length; i++) {
        var pattern = patterns[i];
        pattern.push(function (ev, triples) {
            that.log(triples);
        });
        store_wrap.store.subscribe.apply(store_wrap.store, pattern);
    }

};

Pattern_layer.prototype = Object.create(Layer.prototype);
Pattern_layer.prototype.constructor = Pattern_layer;

module.exports = Pattern_layer;
},{&quot;../../const/css&quot;:2,&quot;../../info&quot;:27,&quot;../../logger.js&quot;:37,&quot;../../store&quot;:44,&quot;../../templating&quot;:47,&quot;../layer&quot;:31}],35:[function(require,module,exports){
/**
 * Layer
 **/

var CSS = require(&quot;../../const/css&quot;), store_wrap = require(&quot;../../store&quot;).get(), templating = require(&quot;../../templating&quot;), log = require(&quot;../../logger.js&quot;)(&quot;Layer_query&quot;);
var info = require(&#x27;../../info&#x27;);
var Layer = require(&#x27;../layer&#x27;);

var Query_layer = function (detripling, decorating, msg, query, opt) {
    Layer.call(this, detripling, decorating, msg, opt);
    this.id = query;
    this._query = query;
    var that = this;

    // Store observing
    store_wrap.store.startObservingQuery.call(store_wrap.store, this._query, function (observed) {
        log(&quot;Got new triples by query&quot;, observed);
        that.triples.add(observed.triples);
    });

    // On new triples
    that.triples.on(&quot;updated&quot;, function (triples, new_triples) {
        log(&quot;Updated&quot;, [triples]);
        that.tileify(triples);
    });
};

Query_layer.prototype = Object.create(Layer.prototype);
Query_layer.prototype.constructor = Query_layer;

Query_layer.prototype.load_local = function () {
    var that = this;
    store_wrap.store.execute(this._query, function (err, results) {
            that.triples.add(results.triples);
        },
        function () {
            info.show(&quot;Error on local triple loading by query&quot;);
        })
};

module.exports = Query_layer;
},{&quot;../../const/css&quot;:2,&quot;../../info&quot;:27,&quot;../../logger.js&quot;:37,&quot;../../store&quot;:44,&quot;../../templating&quot;:47,&quot;../layer&quot;:31}],36:[function(require,module,exports){
var CSS = require(&quot;../const/css&quot;);

var defaults = {
    batch_size: 1
};

var Flex_layout = function (box, footer, msg, opt) {
    this._opt = !opt ? defaults : $.extend({}, defaults, opt);
    this._$footer = footer;
    this._ele = box.get_content_container();
    this.box = box;
    this._msg = msg;
    this.divs = [];
    this.paint_index = 0;
    var that = this;
    this.box.on(&quot;get_more&quot;, function () {
        if (that.paint_index &lt; that.divs.length) {
            that.paint_next();
        } else {
            if (that.paint_index == 0) {
                that.set_footer(0);
            }
            that.box.disable_observer();
        }
    });
    this._backup_divs = [];
};

Flex_layout.prototype.add = function (divs) {
    this.divs = this.divs.concat(divs);
    if (!this.box.has_scroll_bar()) {
        this.box.fill_until_scrollbar();
    }
    this._backup_divs = this.divs;
};

Flex_layout.prototype.paint_next = function () {
    if (this.paint_index &lt; this.divs.length) {
        var end_index = Math.min(this.paint_index + this._opt.batch_size, this.divs.length);
        var divs = [];
        while (this.paint_index &lt; end_index) {
            divs.push(this.divs[this.paint_index]);
            this.paint_index++;
        }
        if (!this._ele.hasClass(CSS.fadeIn))
            this._ele.addClass(CSS.fadeIn);
        this.box.append(divs, function (d) {
            for (var i = 0; i &lt; d.length; i++) {
                d[i].trigger(&quot;appended&quot;);
            }
        });

        //show more tile number
        var unpainted_number = this.divs.length - this.paint_index;
        this.set_footer(this.paint_index, unpainted_number);
    } else {
        this.box.disable_observer();
    }
};

Flex_layout.prototype.set_footer = function (painted_number, unpainted_number) {
    if (unpainted_number) {
        this._$footer.html((painted_number) + &quot; &quot; + this._msg.get(&quot;n_tiles&quot;) + &quot; &quot; + this._msg.get(&quot;and&quot;) + &quot; &quot; + unpainted_number + &quot; &quot; + this._msg.get(&quot;more&quot;));
    } else {
        this._$footer.html((painted_number) + &quot; &quot; + this._msg.get(&quot;n_tiles&quot;));
    }
};

Flex_layout.prototype.clear = function (callback) {
    this.paint_index = 0;
    this.box.clear(callback);
};


Flex_layout.prototype.sort = function (sorter) {
    this.divs.sort(sorter);
    var that = this;
    this.clear(function() {
        setTimeout(function() {that.box.fill_until_scrollbar();}, 0)
    });
};

Flex_layout.prototype.filter = function (filter_functions) {
    var divs = this._backup_divs;
    for (var i = 0, len = filter_functions.length; i &lt; len; i++) {
        var tmp = [];
        for (var j = 0, jlen = divs.length; j &lt; jlen; j++) {
            var tile = $(divs[j]);
            if (filter_functions[i](tile)) {
                tmp.push(tile);
            }
        }
        divs = tmp;
    }
    this.divs = divs;
    var that = this;
    this.clear(function() {
        setTimeout(function() {that.box.fill_until_scrollbar();}, 0)
    });
};

module.exports = Flex_layout;
},{&quot;../const/css&quot;:2}],37:[function(require,module,exports){
(function (global){
/**
 * Wrapper for logger creation
 **/

(typeof window !== &quot;undefined&quot; ? window[&#x27;bows&#x27;] : typeof global !== &quot;undefined&quot; ? global[&#x27;bows&#x27;] : null);
var plugin_prefix = require(&quot;./const/general_plugin.js&quot;).prefix;

var loggers = {};

module.exports = function (str) {
    var id;
    if (str) {
        id = plugin_prefix + str;
    } else {
        id = plugin_prefix;
    }
    if (!loggers[id]) {
        loggers[id] = bows(id);
    }
    return loggers[id];
};
}).call(this,typeof global !== &quot;undefined&quot; ? global : typeof self !== &quot;undefined&quot; ? self : typeof window !== &quot;undefined&quot; ? window : {})
},{&quot;./const/general_plugin.js&quot;:3}],38:[function(require,module,exports){
var log = require(&quot;./logger&quot;)(&quot;Language&quot;);

var Languages = function (language) {
    this.languages = {
        en: require(&quot;./languages/en.json&quot;),
        de: require(&quot;./languages/de.json&quot;)
    };
    this.set_language(language);
};

Languages.prototype.get = function (id) {
    if (this.languages[this._cur][id]) {
        return this.languages[this._cur][id];
    } else {
        log(&quot;Couldn&#x27;t find &quot; + id + &quot; in language object.&quot;);
        return id;
    }
};

Languages.prototype.set = function (lang, id, val) {
    this.languages[lang][id] = val;
};

Languages.prototype.set_language = function (language) {
    this._cur = this.languages[language] ? language : &quot;en&quot;;
};

Languages.prototype.get_language = function () {
    return this._cur;
};

module.exports = Languages;
},{&quot;./languages/de.json&quot;:28,&quot;./languages/en.json&quot;:29,&quot;./logger&quot;:37}],39:[function(require,module,exports){
var CSS = require(&quot;./const/css&quot;), templating = require(&quot;./templating&quot;), e_ext = require(&quot;./util/event_obj_extender&quot;), log = require(&quot;./logger.js&quot;)(&quot;Overlay&quot;), History = require(&quot;./history&quot;), Nav = require(&quot;./html_obj/nav&quot;);
var pN = require(&quot;./const/general_plugin&quot;).name;
var defaults = {};

var Overlay = function (layer, msg, z_index, ele, opt) {
    this._opt = !opt ? defaults : $.extend({}, defaults, opt);
    this._cur_z_index = z_index;
    this._$html = $(templating[&#x27;overlay&#x27;]({CSS: CSS, z_index: z_index, label: layer.label, label_small: layer.label_small}));

    var that = this;
    this._menu = $(this._$html.find(&quot;.&quot; + CSS.menu));
    this._inner_menu = $(this._$html.find(&quot;.&quot; + CSS.overlay_menu));
    this.back_btn = new Nav(function () {
        that.trigger(&quot;go_back&quot;);
    }, msg.get(&quot;back&quot;), this._inner_menu);
    this.history_btn = new Nav(
        function () {
            that.trigger(&quot;show_history&quot;);
        }, msg.get(&quot;history&quot;), this._inner_menu, [&quot;fa&quot;, &quot;fa-history&quot;]);
    this.history_btn.toggle_disable();
    this.close_btn = new Nav(function () {
            that.close();
        }, msg.get(&quot;close&quot;), this._inner_menu, [&quot;fa&quot;, &quot;fa-times&quot;]
    );

    this._$content = this._$html.find(&quot;.&quot; + CSS.overlay_content);

    ele.append(this._$html);

// Extend with events
    return e_ext(this);
};

Overlay.prototype.set_content = function (ele) {
    this._$content.empty();
    this._$content.append(ele);
};

Overlay.prototype.get_content = function () {
    return this._$content;
};

Overlay.prototype.show = function (clip) {
    if (clip)
        log(clip);
    //TODO transition start

    this._$html.addClass(CSS.fadeIn);
};

Overlay.prototype.hide = function (clip, cb) {
    if (clip)
        log(clip);
    // TODO transition end

    if (cb)
        // TODO hide transition
        cb();
        //if (L_util.getTransitionSupport()) {
        //    this._$html.once(L_util.getTransEndEventName(), cb);
        //} else {
        //    cb();
        //}
    this._$html.removeClass(CSS.fadeIn);
};

Overlay.prototype.set_color = function(color) {
    this._menu.css(&quot;background-color&quot;, color);
};

Overlay.prototype.close = function (clip) {
    var that = this;
    this.hide(null, function () {
        that.trigger(&quot;closed&quot;);
        that.destroy();
    });
};

Overlay.prototype.destroy = function () {
    if (this.get_content().data(pN + &quot;_layer&quot;))
        this.get_content().data(pN + &quot;_layer&quot;).destroy();
    this._$html.remove();
};

module.exports = Overlay;
},{&quot;./const/css&quot;:2,&quot;./const/general_plugin&quot;:3,&quot;./history&quot;:24,&quot;./html_obj/nav&quot;:25,&quot;./logger.js&quot;:37,&quot;./templating&quot;:47,&quot;./util/event_obj_extender&quot;:48}],40:[function(require,module,exports){
/**
 * Overlay management for synopsis
 **/

var CSS = require(&quot;./const/css&quot;), store = require(&quot;./store&quot;).get(), templating = require(&quot;./templating&quot;),
    log = require(&quot;./logger.js&quot;)(&quot;Overlay_manager&quot;), History = require(&quot;./history&quot;),
    Overlay = require(&quot;./overlay&quot;);

var defaults = {z_index: 2000, max_overlays: 1};

var Overlay_manager = function (history, msg, ele, opt) {
    this.overlays = [];
    this._opt = !opt ? defaults : $.extend({}, defaults, opt);
    this._cur_z_index = this._opt.z_index;
    this._$container = $(templating[&#x27;overlay_container&#x27;]({CSS: CSS}));
    ele.append(this._$container);
    this._$parent = $(ele);
    this._history = history;
    this._msg = msg;
};

Overlay_manager.prototype.make_overlay = function (layer) {
    var overlay = new Overlay(layer, this._msg, this._cur_z_index, this._$container);
    this._history.add(layer);
    var that = this;
    overlay.on(&quot;go_back&quot;, function() {
        that._history.back();
    });
    overlay.on(&quot;show_history&quot;, function() {
        that._history.show();
    });
    this.overlays.push(overlay);
    this._cur_z_index++;
    if (this._opt.max_overlays &lt; this.overlays.length) {
        var o = this.overlays.shift();
        o.destroy();
    }
    overlay.show();

    // hide scrollbars of parents
    if (this.overlays.length == 1) {
        this._$container.parents().addClass(CSS.no_scroll);
    }
    overlay.on(&quot;closed&quot;, function () {
        that.overlays.pop();
        if (that.overlays.length == 0) {
            that._$container.parents().removeClass(CSS.no_scroll);
        }
    });

    return overlay;
};

Overlay_manager.prototype.destroy_all = function () {
    for (var i = 0; i &lt; this.overlays.length; i++) {
        this.overlays[i].destroy();
    }
};

module.exports = Overlay_manager;
},{&quot;./const/css&quot;:2,&quot;./history&quot;:24,&quot;./logger.js&quot;:37,&quot;./overlay&quot;:39,&quot;./store&quot;:44,&quot;./templating&quot;:47}],41:[function(require,module,exports){
(function (global){
/**
 * Singleton Progress box creation.
 **/

var $ = (typeof window !== &quot;undefined&quot; ? window[&#x27;$&#x27;] : typeof global !== &quot;undefined&quot; ? global[&#x27;$&#x27;] : null), CSS = require(&quot;./const/css.js&quot;), templating = require(&#x27;./templating&#x27;), e_ext = require(&quot;./util/event_obj_extender&quot;);

var DONE_DELETE = 1200, DONE_FADE = 1000;

var Progress_Bar = function (label, progress_num) {
    this._$html = $(templating[&quot;progress_bar&quot;]({CSS: CSS, label: label}));
    this._progress = Array.apply(null, new Array(progress_num)).map(Number.prototype.valueOf, 0);
    this._partial = Array.apply(null, new Array(progress_num)).map(Number.prototype.valueOf, 1);
    this._$progress_bar = this._$html.find(&quot;.&quot; + CSS.progress_bar);
    return e_ext(this);
};

Progress_Bar.prototype.get_progress = function () {
    var progress_n = 0;
    for (var i = 0; i &lt; this._progress.length; i++) {
        progress_n += this._progress[i];
    }
    return progress_n;
};

Progress_Bar.prototype.get_max_progress = function () {
    return this._progress.length;
};

Progress_Bar.prototype.do_progress = function (index) {
    this._progress[index] = 1;
    var q = this.get_progress() / this.get_max_progress();
    this._$progress_bar.width(q * 100 + &quot;%&quot;);
    if (q == 1) {
        this.done();
    }
};

Progress_Bar.prototype.do_partial_progress = function (index) {
    this._progress[index] = 1 - (1 / (this._partial[index] += 0.25));
    var q = this.get_progress() / this.get_max_progress();
    this._$progress_bar.width(q * 100 + &quot;%&quot;);
};

Progress_Bar.prototype.do_warn = function () {
    this._$progress_bar.addClass(&quot;progress-bar-warning&quot;);
};

Progress_Bar.prototype.do_stop = function () {
    this._$progress_bar.addClass(&quot;progress-bar-warning&quot;);
    this._$progress_bar.addClass(&quot;progress-bar-striped&quot;);
    this._$progress_bar.width(&quot;100%&quot;);
    this.done();
};

Progress_Bar.prototype.remove = function () {
    this._$html.remove();
};

Progress_Bar.prototype.done = function () {
    this.trigger(&quot;done&quot;);
};

var Progress = function () {
    this.unappended = true;
    this.bar_num = 0;
    this._$html = $(templating[&quot;progress&quot;]({CSS: CSS}));
    // Remote &amp; progress
    this._$progress_container = this._$html.find(&quot;.&quot; + CSS.progress_container);

    var that = this;
    this._$html.click(function () {
        setTimeout(function () {
            that.hide();
        }, 100);
    });
};

Progress.prototype.append_to = function (ele) {
    $(ele).append(this._$html);
    this.unappended = false;
};

Progress.prototype.make_n_add_bar = function (label, n) {
    var bar = new Progress_Bar(label, n), that = this;
    bar.on(&quot;done&quot;, function (bar) {
        return function () {
            that.bar_num--;
            if (that.bar_num == 0) {
                setTimeout(function () {
                    that.hide();
                }, DONE_FADE)
            }
            setTimeout(function () {
                bar.remove();
            }, DONE_DELETE)
        }
    }(bar));
    this.bar_num++;
    this._$progress_container.append(bar._$html);
    return bar;
};

Progress.prototype.show = function () {
    this._$html.addClass(CSS.fadeIn);
};

Progress.prototype.hide = function () {
    this._$html.removeClass(CSS.fadeIn);
};

var instance = new Progress();

module.exports = instance;
}).call(this,typeof global !== &quot;undefined&quot; ? global : typeof self !== &quot;undefined&quot; ? self : typeof window !== &quot;undefined&quot; ? window : {})
},{&quot;./const/css.js&quot;:2,&quot;./templating&quot;:47,&quot;./util/event_obj_extender&quot;:48}],42:[function(require,module,exports){
var e_ext = require(&quot;../util/event_obj_extender&quot;);

var max_url_length = 2000;

var Debounced_remote_loader = function (synopsis, query, url, fail) {
    this.synopsis = synopsis;
    this.query = query;
    this.values = [];
    this.value_map = {};
    this.cbs = {};
    this.fail = fail;
    this.url = url;
    this.query_length = encodeURIComponent(query).length;
    var that = e_ext(this);
    that.on(&quot;DoQuery&quot;, function () {
        that.run_on_remote();
    }.debounce(100));
    return that;
};

Debounced_remote_loader.dummy = &quot;Filter_()&quot;;

Debounced_remote_loader.prototype.add_value = function (val, cb) {
    if (this.synopsis._opt.dyn_remote) {
        var encoded_uri_part_length = encodeURIComponent(&quot;&lt;&quot; + val + &quot;&gt; || &quot;);
        // Ignore debounce if max length is reached
        if (this.query_length + encoded_uri_part_length.length &gt; max_url_length) {
            this.run_on_remote();
        }

        // Add new to debounced query
        if (!this.value_map[val]) {
            this.value_map[val] = true;
            this.values.push(val);
            this.query_length += encoded_uri_part_length.length;
            if (!this.cbs[val])
                this.cbs[val] = [];
            this.cbs[val].push(cb);
            this.trigger(&quot;DoQuery&quot;);
        }
    } else {
        cb([]);
    }
};

Debounced_remote_loader.prototype.run_on_remote = function () {
    var that = this;
    if (that.values.length &gt; 0) {
        var query_values = that.values.slice();
        this.synopsis.execute_on_remote(this.pop_query(), this.url, function (res) {
            var bindings = {};
            for (var i = 0; i &lt; res.results.bindings.length; i++) {
                var val = res.results.bindings[i].value.value;
                if (!bindings[val])
                    bindings[val] = [];
                bindings[val].push(res.results.bindings[i]);
            }
            for (var j = 0; j &lt; query_values.length; j++) {
                if (!bindings[query_values[j]]) {
                    for (var k = 0; k &lt; that.cbs[query_values[j]].length; k++) {
                        that.cbs[query_values[j]][k]([]);
                    }
                } else {
                    for (var k = 0; k &lt; that.cbs[query_values[j]].length; k++) {
                        that.cbs[query_values[j]][k](bindings[query_values[j]]);
                    }
                }
            }
        }, this.fail);
    }
};

Debounced_remote_loader.prototype.pop_query = function () {
    var values = this.values;
    this.query_length = encodeURIComponent(this.query).length;
    this.values = [];
    var replacement = &quot;Filter (&quot;;
    for (var i = 0; i &lt; values.length; i++) {
        delete this.value_map[values[i]];
        replacement += &quot;?value=&quot; + &quot;&lt;&quot; + values[i] + &quot;&gt;&quot;;
        if (i &lt; values.length - 1)
            replacement += &quot; || &quot;
    }
    replacement += &quot;)&quot;;
    return this.query.replace(Debounced_remote_loader.dummy, replacement);
};

module.exports = Debounced_remote_loader;
},{&quot;../util/event_obj_extender&quot;:48}],43:[function(require,module,exports){
(function (global){
/**
 * Singleton store local
 **/

var rdfstore = (typeof window !== &quot;undefined&quot; ? window[&#x27;rdfstore&#x27;] : typeof global !== &quot;undefined&quot; ? global[&#x27;rdfstore&#x27;] : null), $ = (typeof window !== &quot;undefined&quot; ? window[&#x27;$&#x27;] : typeof global !== &quot;undefined&quot; ? global[&#x27;$&#x27;] : null), log = require(&quot;./../logger.js&quot;)(&quot;Remote&quot;);

/**
 * Remote loading for rdf data via describe queries.
 *
 * @param url Triple of parts of the service url. The join of the complete array should map to a query execution on the service. Consists of a tupel of strings where the query is to be inserted in between. Used for CORS.
 * @constructor
 * @param url
 */
var Remote = function (url) {
    if (url.length != 3) {
        throw Error(&quot;Url must be split in 3 parts. I) The service url ex: &#x27;http://dbpedia.org/sparql&#x27; II) + III) The rest of the url where the query can be placed in between.&quot;);
    }
    this._service = url[0];
    this._exec_url = [url[1], url[2]];
};

/**
 * Creates the cors request object
 *
 * @param method
 * @param url
 * @returns {XMLHttpRequest}
 * @private
 */
Remote.prototype._createCORSRequest = function (method, url) {
    var xhr = new XMLHttpRequest();
    if (typeof xhr.withCredentials !== &quot;undefined&quot;) {

        // XMLHTTPRequest2 objects
        xhr.open(method, url, true);

    } else if (typeof XDomainRequest !== &#x27;undefined&#x27;) {

        // IE workaround
        xhr = new XDomainRequest();
        xhr.open(method, url);

    } else {
        xhr = null;
    }
    return xhr;
};

Remote.prototype.get_service_name = function () {
    return this._service;
};

/**
 * Execute given query on sparql service via cors.
 *
 * @param query
 * @param cb
 * @param fail
 * @param flag
 */
Remote.prototype.execute = function (query, cb, fail, flag) {
    var xhr = this._createCORSRequest(&#x27;GET&#x27;, this._service + this._exec_url[0] + encodeURIComponent(query) + this._exec_url[1]), that = this;
    xhr.setRequestHeader(&quot;accept&quot;, &quot;application/json&quot;);
    if (flag) {
        flag.on(&quot;interrupt&quot;, function() {
            log(&quot;Aborted remote query.&quot;);
            xhr.abort();
            flag.off(&quot;interrupt&quot;, this);
        });
    }
    xhr.onload = function () {
        if (this.status == 200 &amp;&amp; this.readyState == 4 &amp;&amp; this.responseText != &quot;&quot;) {
            cb(JSON.parse(xhr.responseText));
        } else {
            log(&quot;There was an service error for query: &quot; + query + &quot; on backend: &quot; + that._service, xhr);
            fail();
        }
    };
    xhr.onerror = function () {
        log(&quot;There was an transport error for query: &quot; + query + &quot; on backend: &quot; + that._service, xhr);
        fail();
    };
    xhr.send();
};

var counter = 0;


/**
 * Execute given query on sparql service via yql. Fix YQL.
 * @param query
 * @param cb
 * @param fail
 */
//Remote.prototype.execute_yql = function (query, cb, fail) {
//    var success = false, cnt = counter++;
//    // Use cnt to stop callbackoverwriting on simultan calls
//    window[&quot;cbFunc&quot; + cnt] = function (data, textStatus, jqXHR) {
//        // If we have something to work with...
//        if (data &amp;&amp; data.query &amp;&amp; data.query.results) {
//            success = true;
//            cb(data.query.results);
//        }
//
//        // Else, Maybe we requested a site that doesn&#x27;t exist, and
//        // nothing returned.
//        else {
//            log(&#x27;Nothing returned from getJSON.&#x27;);
//            fail();
//
//            // Delete old callbackfunction
//            window[&quot;cbFunc&quot; + cnt] = undefined;
//        }
//    };
//
//    // If no query was passed, exit.
//    if (!query) {
//        alert(&#x27;No query was passed.&#x27;);
//    }
//
//    // Take the provided url, and add it to a YQL query. Make sure you
//    // encode it!
//    var yql = &#x27;http://query.yahooapis.com/v1/public/yql?q=&#x27;
//        + encodeURIComponent(&#x27;use &quot;http://triplr.org/sparyql/sparql.xml&quot; as sparql; select * from sparql where query=&quot;&#x27;
//        + query + &#x27;&quot; and service=&quot;&#x27; + this._service) + &#x27;&quot;&amp;format=json&#x27;;
//
//    // Request that YSQL string, and run a callback function.
//    // Pass a defined function to prevent cache-busting.
//    $.ajax({
//        type: &#x27;post&#x27;,
//        dataType: &#x27;json&#x27;,
//        url: yql,
//        success: window[&quot;cbFunc&quot; + cnt],
//        error: function (jqXHR, textStatus, errorThrown) {
//            fail();
//        }
//    });
//};

module.exports = Remote;
}).call(this,typeof global !== &quot;undefined&quot; ? global : typeof self !== &quot;undefined&quot; ? self : typeof window !== &quot;undefined&quot; ? window : {})
},{&quot;./../logger.js&quot;:37}],44:[function(require,module,exports){
(function (global){
/**
 * Singleton local rdf store. Needs to be set once.
 **/

var rdfstore = (typeof window !== &quot;undefined&quot; ? window[&#x27;rdfstore&#x27;] : typeof global !== &quot;undefined&quot; ? global[&#x27;rdfstore&#x27;] : null), $ = (typeof window !== &quot;undefined&quot; ? window[&#x27;$&#x27;] : typeof global !== &quot;undefined&quot; ? global[&#x27;$&#x27;] : null), log = require(&quot;./logger.js&quot;)(&quot;Store&quot;), RDFModel = window.RDFModel, Util = require(&quot;./util/misc.js&quot;);

var defaults = {
    &quot;trigger_on_batch_loading&quot;: false,
    &quot;rdfstore&quot;: {
        &quot;persistent&quot;: false,
        &quot;name&quot;: &quot;local_rdf&quot;
    }
};

var Parser = function(store) {
    this.store = store;
};

Parser.prototype.parse_to_graph = function(bindings, structure) {
    if (!structure) {
        structure = [&quot;s&quot;, &quot;p&quot;, &quot;o&quot;];
    }
    var graph = this.store.create_graph();
    for (var i = 0; i &lt; bindings.length; i++) {
        var triple_data = [];
        for (var j = 0; j &lt; structure.length; j++) {
            var atom = bindings[i][structure[j]];
            if (!atom.token)
                atom.token = atom.type; // RDFModel needs token attribute, not type attribute
            if (atom.token === &quot;literal&quot; || atom.token === &quot;typed-literal&quot;) {
                atom.token = &quot;literal&quot;;
                atom.value = Util.add_slashes(atom.value.toString()); // Escape quotes etc in literal values
            }
            triple_data[j] = RDFModel.buildRDFResource(atom, null, this.store.get_engine(), {blanks: {}, outCache: {}});
        }
        graph.add(this.store.create_triple.apply(this.store, triple_data));
    }
    return graph;
};


/**
 * Implements interface to local rdf store.
 *
 * @param opt
 * @constructor
 */
var Store = function (opt) {
    require(&quot;./util/event_obj_extender.js&quot;)(this);
    var that = this;
    this._opt = !opt ? defaults : $.extend({}, defaults, opt);
    this.parser = new Parser(this);
    that.init_dfd = $.Deferred();
    rdfstore.create(this._opt.rdfstore, function (err, store) {

        // common name-spaces like rdf, rdfs, foaf, etc
        store.registerDefaultProfileNamespaces();
        that._local_store = store;
        that.init_dfd.resolve();
        if (that._opt.trigger_on_batch_loading) {
            store.setBatchLoadEvents(true);
        }
    });
};

/**
 * Returns initialization promise statement
 * @returns {*}
 */
Store.prototype.init_done = function () {
    return this.init_dfd.promise();
};

Store.prototype.create_graph = function () {
    return this._local_store.rdf.createGraph.apply(this._local_store, arguments);
};

Store.prototype.create_triple = function () {
    return this._local_store.rdf.createTriple.apply(this._local_store, arguments)
};

Store.prototype.get_engine = function () {
    return this._local_store.engine;
};

Store.prototype.insert_serialized_str = function (str, format, cb) {
    var parser = this._local_store.engine.rdfLoader.parsers[format];
    var that = this;
    //synopsis.store._local_store.engine.rdfLoader.tryToParse(parser, null, str, null, function(e, triples) {
    //    synopsis.store._local_store.insert(that.parser.parse_to_graph(triples, [&quot;subject&quot;, &quot;predicate&quot;, &quot;object&quot;]), cb);
    //});
    this._local_store.load(format, str, function (err, results) {
        if (cb)
            cb(err, results);
    });
};

/**
 *
 */
Store.prototype.subscribe = function () {
    this._local_store.subscribe.apply(this._local_store, arguments);
};

/**
 *
 */
Store.prototype.unsubscribe = function () {
    this._local_store.unsubscribe.apply(this._local_store, arguments);
};

/**
 *
 */
Store.prototype.startObservingNode = function () {
    this._local_store.startObservingNode.apply(this._local_store, arguments);
};

/**
 *
 */
Store.prototype.stopObservingNode = function () {
    this._local_store.stopObservingNode.apply(this._local_store, arguments);
};

/**
 *
 */
Store.prototype.startObservingQuery = function () {
    this._local_store.startObservingQuery.apply(this._local_store, arguments);
};

/**
 *
 */
Store.prototype.stopObservingQuery = function () {
    this._local_store.stopObservingQuery.apply(this._local_store, arguments);
};

/**
 * Inserts given triples into the store.
 *
 * @param bindings
 * @param structure Array of keys in binding
 * @param cb
 */
Store.prototype.insert_triples = function (bindings, structure, cb) {
    this.insert_graph(this.parser.parse_to_graph(bindings, structure), cb);
};

Store.prototype.insert_graph = function (graph, cb) {
    //this._local_store.insert(graph, function () {
    //    cb(d);
    //});
    // rdfstore-js bug workaround (can&#x27;t handle multiple executions at once)
    var that = this;
    if (!this._execQueue) {
        this._execQueue = [];
        this._execNext = function () {
            if (that._execQueue.length &gt;= 1) {
                var fn = that._execQueue[0];
                fn(function (c) {
                    that._execQueue.shift();
                    that._execNext();
                });
            }
        };
    }
    this._execQueue.push(function (g, c) {
        return function () {
            that._local_store.insert(g, function () {
                c.apply(null, arguments);
            });
        }
    }(graph, cb));
    if (this._execQueue.length == 1) {
        this._execNext();
    }
//! rdfstore-js bug workaround (can&#x27;t handle multiple executions at once)
};

//Store.prototype.insert_by_query = function (bindings, structure, cb) {
//    // rdfstore-js bug workaround (can&#x27;t handle multiple executions at once)
//    var that = this;
//    if (!this._execQueue) {
//        this._execQueue = [];
//        this._execNext = function () {
//            if (that._execQueue.length &gt;= 1) {
//                var fn = that._execQueue[0];
//                fn(function (c) {
//                    that._execQueue.shift();
//                    that._execNext();
//                    c();
//                });
//            }
//        };
//    }
//    var query = this._generateInsertionQuery(bindings, structure);
//    this._execQueue.push(function (q, d) {
//        return function (c) {
//            that._local_store.execute(q, function () {
//                c(d);
//            });
//        }
//    }(query, cb));
//    if (this._execQueue.length == 1) {
//        this._execNext();
//    }
////! rdfstore-js bug workaround (can&#x27;t handle multiple executions at once)
//};
//
///**
// * Generate insertion SPARQL command to use for the store out of json results returned by backend.
// *
// * @private
// * @method _generateInsertionQuery
// * @param bindings JSON result
// */
//Store.prototype._generateInsertionQuery = function (bindings, structure) {
//    if (!structure) {
//        structure = [&quot;s&quot;, &quot;p&quot;, &quot;o&quot;];
//    }
//    var type_map = { subject : &quot;s&quot;, predicate: structure[1], object: structure[2]};
//    var insertionQuery = &quot;INSERT DATA {&quot;;
//    $.each(bindings, function (i, val) {
//        if (val[type_map.subject] === undefined) {
//            log(&quot;Resultset disfigured.&quot;);
//        } else if (val[type_map.subject].type === &quot;uri&quot;) {
//            insertionQuery += &quot;&lt;&quot; + val[type_map.subject].value + &quot;&gt; &quot;;
//        } else {
//            // TODO BlankNodes
//            log(&quot;TODO BLANKNODE&quot;);
//            insertionQuery += &quot;&lt;&quot; + val[type_map.subject].value + &quot;&gt; &quot;;
//        }
//        insertionQuery += &quot;&lt;&quot; + val[type_map.subject].value + &quot;&gt; &quot;;
//        if (val[type_map.object].type === &quot;uri&quot;) {
//            insertionQuery += &quot;&lt;&quot; + val[type_map.object].value + &quot;&gt;. &quot;;
//        } else if (val[type_map.object].type === &quot;literal&quot;) {
//            insertionQuery += &#x27;&quot;&#x27; + encodeURIComponent(val[type_map.object].value) + &#x27;&quot;. &#x27;;
//        } else if (val[type_map.object].type === &quot;typed-literal&quot;) {
//            // TODO typed-literals
//            insertionQuery += &#x27;&quot;&#x27; + encodeURIComponent(val[type_map.object].value) + &#x27;&quot;. &#x27;;
//        }
//    });
//    insertionQuery += &quot;}&quot;;
//    return insertionQuery;
//};

/**
 * Execute given query on store.
 * @param query
 * @param cb
 * @param fail
 */
Store.prototype.execute = function (query, cb, fail) {
    this._local_store.execute(query, function (err, results) {
        if (err &amp;&amp; fail) {
            fail(err, results);
        }
        if (cb)
            cb(err, results);

    });
};

Store.prototype.clear = function () {
    this._local_store.clear();
};

// Singleton instance
var instance = {}, cur = 0;
module.exports = {
    get: function() {
        if (!instance.store)
            instance.store = new Store();
        return instance;
    },
    set : function (opt) {
        if (instance.store)
            if (instance.store.init_done() == &quot;resolve&quot;) {
                instance.store.clear();
            } else {
                instance.store.init_dfd.reject();
            }
        instance.store = new Store(opt);
    }
};
}).call(this,typeof global !== &quot;undefined&quot; ? global : typeof self !== &quot;undefined&quot; ? self : typeof window !== &quot;undefined&quot; ? window : {})
},{&quot;./logger.js&quot;:37,&quot;./util/event_obj_extender.js&quot;:48,&quot;./util/misc.js&quot;:50}],45:[function(require,module,exports){
(function (global){
var $ = (typeof window !== &quot;undefined&quot; ? window[&#x27;$&#x27;] : typeof global !== &quot;undefined&quot; ? global[&#x27;$&#x27;] : null);
(typeof window !== &quot;undefined&quot; ? window[&#x27;rdfstore&#x27;] : typeof global !== &quot;undefined&quot; ? global[&#x27;rdfstore&#x27;] : null);
var plugin_name = require(&quot;./const/general_plugin&quot;).name;
var GUID = 0, synopsis_instances = [], log = require(&quot;./logger&quot;)();
var Util = require(&quot;./util/misc&quot;), Remote = require(&quot;./remote/remote&quot;), info = require(&#x27;./info&#x27;), progress = require(&#x27;./progress&#x27;);
var Overlay_m = require(&quot;./overlay_manager&quot;), RDFModel = window.RDFModel, Layer_factory = require(&quot;./layers/factory&quot;);
var Msg = require(&quot;./msg&quot;), History = require(&quot;./history&quot;);
var Detripler_manager = require(&quot;./detripling/manager&quot;), Decorator_manager = require(&quot;./decorating/manager&quot;);

//var defaults = require(&quot;./defaults.json&quot;);
var defaults = {
    &quot;lang&quot;: &quot;en&quot;,
    &quot;dyn_remote&quot;: true,
    &quot;remote_batch_size&quot;: 9999,
    &quot;store&quot;: {},
    &quot;detripling&quot;: {},
    &quot;decorating&quot;: {},
    &quot;remote&quot;: [
        [
            &quot;http://dbpedia.org/sparql&quot;,
            &quot;?default-graph-uri=http%3A%2F%2Fdbpedia.org&amp;query=&quot;,
            &quot;&amp;format=application%2Fsparql-results%2Bjson&amp;timeout=300000&quot;
        ]
    ]
};

/**
 * Extend jQUery selector for contains
 */
$.expr[&quot;:&quot;].containsInsensitive = $.expr.createPseudo(function (arg) {
    return function (elem) {
        return $(elem).text().toUpperCase().indexOf(arg.toUpperCase()) &gt;= 0;
    };
});

/**
 * Main plugin class
 *
 * @param ele Parent element
 * @param opt Options object
 * @constructor
 * @param cb Callback on init
 */
var Synopsis = function (ele, opt, cb) {
    // use element as selector string
    if (typeof ele === &#x27;string&#x27;) {
        ele = document.querySelector(ele);
    }
    if (!ele) {
        ele = $(&quot;&lt;div&gt;&lt;/div&gt;&quot;);
    }
    this._$ele = $(ele);
    if (info.unappended)
        info.append_to(ele);
    this.info = info;
    this.css = require(&quot;./const/css&quot;);

    if (progress.unappended)
        progress.append_to(ele);
    this.progress = progress;

    this.init_dfd = $.Deferred();

    this.rdf = RDFModel.rdf;

    // options
    if (opt) {
        this._opt = $.extend(true, {}, defaults, opt);
    } else {
        this._opt = $.extend(true, {}, defaults);
    }

    this.msg = new Msg(this._opt.lang);

    this.detriple_manager = new Detripler_manager(this._opt.detripling);
    this.decorator_manager = new Decorator_manager(this._opt.decorating, this);
    this.id = GUID++;

    this.remote = [];
    if (this._opt.remote) {
        for (var i = 0; i &lt; this._opt.remote.length; i++) {
            this.remote.push(new Remote(this._opt.remote[i]));
        }
    }

    var store_opt = Util.opt_get(this._opt, &quot;store&quot;), Store = require(&quot;./store&quot;);
    if (store_opt)
        Store.set(store_opt);
    this.store_wrap = Store.get();
    var that = this;
    $.when(this.store_wrap.store.init_done()).done(function () {
            that.init_dfd.resolve();
            if (cb)
                cb(that);
        }
    );

    this._history = new History(this);

    var overlay_m_opt = Util.opt_get(that._opt, &quot;overlay_manager&quot;);
    that.overlay_manager = new Overlay_m(this._history, this.msg, that._$ele, overlay_m_opt);

    synopsis_instances[this.id] = this; // associate via id
};

Synopsis.Layer_factory = Layer_factory;

Synopsis.prototype.init_done = function () {
    return this.init_dfd.promise();
};

// Data insertion

Synopsis.prototype.fetch = function (uri, cb, fail) {
    var that = this;
    for (var i = 0; i &lt; this.remote.length; i++) {
        this.remote[i].execute(&quot;DESCRIBE &quot; + uri, function (resp) {
            that.store_wrap.store.insert_triples(resp.results.bindings);
            cb(resp);
        }, fail);
    }
};

Synopsis.prototype.execute_on_remote = function (query, url, cb, fail) {
    var use_predef_remotes = false, did_remote = false;
    if (!url || url == &quot;&quot; || url == null) {
        use_predef_remotes = true;
    }

    for (var i = 0; i &lt; this.remote.length; i++) {
        if (use_predef_remotes || url == this.remote[i].get_service_name()) {
            did_remote = true;
            this.remote[i].execute(query,
                function (remote_num) {
                    return function (resp) {
                        if (cb)
                            cb(resp, remote_num);
                    }
                }(i),
                function (remote_num) {
                    return function (e) {
                        if (fail)
                            fail(e, remote_num);
                    }
                }(i));
        }
    }
    if (!did_remote)
        info.show(&quot;Remote service isn&#x27;t added to remote backends. Execute on remote failed.&quot;);
};

Synopsis.prototype.execute_on_remote_with_limits = function (query, p_query_num, flag, cb, fail) {
    var tmp_query = query + &quot; LIMIT &quot; + this._opt.remote_batch_size + &quot; OFFSET &quot; + p_query_num * this._opt.remote_batch_size, that = this;
    this.execute_on_remote(tmp_query, null,
        function (q, fl, c, f) {
            return function (resp, remote_num) {
                if (resp.results.bindings.length &gt; 0 &amp;&amp; (!fl || !fl.interrupt)) {
                    if (resp.results.bindings.length == that._opt.remote_batch_size) {
                        setTimeout(function () {
                            that.execute_on_remote_with_limits(q, p_query_num + 1, fl, c, f)
                        }, 100);

                        // callback with response, number of remote service and partial true flag
                        c(resp, remote_num, true);
                    } else {

                        // callback with response, number of remote service and partial false flag
                        c(resp, remote_num, false);
                    }
                }
            }
        }(query, flag, cb, fail), fail, flag);
};

Synopsis.prototype.insert_file = function (file, cb) {
    var that = this;
    $.when(this.init_done()).done(function () {
            that._insert_file(file, cb);
        }
    );
};

Synopsis.prototype._insert_file = function (file, cb) {
    var that = this, reader = new FileReader();
    reader.onload = function () {
        var type = &quot;text/turtle&quot;;
        if (file.type === &quot;&quot;) {
            var extension = file.name.split(&quot;.&quot;).pop();
            switch (extension) {
                case &quot;ttl&quot;:
                case &quot;turtle&quot;:
                    type = &quot;text/turtle&quot;;
                    break;
                case &quot;nt&quot;:
                case &quot;n3&quot;:
                    type = &quot;text/n3&quot;;
                    break;
                case &quot;json&quot;:
                    type = &quot;application/json&quot;;
                    break;
                case &quot;jsld&quot;:
                    type = &quot;application/ld+json&quot;;
                    break;
                default:
                    var str = &quot;Unknown file type extension: &quot; + extension;
                    info.show(str);
                    log(str);
            }
        } else {
            type = file.type;
        }
        var read = this.result;
        that._insert_serialized_str(read, type, cb);
    };
    reader.readAsText(file);
};

Synopsis.prototype.insert_serialized_str = function (data, format, cb) {
    var that = this;
    $.when(this.init_done()).done(function () {
            that.insert_serialized_str(data, format, cb);
        }
    );
};

Synopsis.prototype._insert_serialized_str = function (data, format, cb) {
    this.store_wrap.store.insert_serialized_str(data, format, cb);
};

// !Data insertion

Synopsis.prototype.add_backend = function (url) {
    this.remote.push(url);
};

Synopsis.prototype._show = function (layer, cb) {
    var overlay = this.overlay_manager.make_overlay(layer);
    layer.show_on(overlay.get_content());
    overlay.show();
    var view = {overlay: overlay, layer: layer};
    if (cb)
        cb(view);
    return view;
};

Synopsis.prototype.show = function (layer, cb) {
    if (this._opt.dyn_remote) {
        layer.load_remote();
    }
    return this._show(layer, cb);
};

Synopsis.prototype.get_remote_count = function () {
    return this._opt.remote.length;
};

Synopsis.prototype.clear = function () {
    this.store_wrap.store.clear();
};

// ----- destroy ----- //

/**
 * Clean up after plugin (destroy bindings, clear events..)
 *
 * @method destroy
 */
Synopsis.prototype._destroy = function () {
    this.store_wrap.store.clear();
    delete synopsis_instances[this.id];
};

// make into jQuery plugin
// Lightweight plugin frame.
$.fn[plugin_name] = function (options, cb) {
    return this.each(function () {
        if (!$.data(this, &quot;plugin_&quot; + plugin_name)) {
            $.data(this, &quot;plugin_&quot; + plugin_name, new Synopsis(this, options, cb));
        } else {
            log(&quot;Data plugin_&quot; + plugin_name + &quot;already set.&quot;);
        }
    });
};

window[plugin_name.charAt(0).toUpperCase() + plugin_name.slice(1)] = Synopsis;
module.exports = Synopsis;

//Copyright 2013 Thomas Weissgerber
//
//Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
//you may not use this file except in compliance with the License.
//You may obtain a copy of the License at
//
//http://www.apache.org/licenses/LICENSE-2.0
//
//Unless required by applicable law or agreed to in writing, software
//distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
//WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
//See the License for the specific language governing permissions and
//limitations under the License.
}).call(this,typeof global !== &quot;undefined&quot; ? global : typeof self !== &quot;undefined&quot; ? self : typeof window !== &quot;undefined&quot; ? window : {})
},{&quot;./const/css&quot;:2,&quot;./const/general_plugin&quot;:3,&quot;./decorating/manager&quot;:12,&quot;./detripling/manager&quot;:20,&quot;./history&quot;:24,&quot;./info&quot;:27,&quot;./layers/factory&quot;:30,&quot;./logger&quot;:37,&quot;./msg&quot;:38,&quot;./overlay_manager&quot;:40,&quot;./progress&quot;:41,&quot;./remote/remote&quot;:43,&quot;./store&quot;:44,&quot;./util/misc&quot;:50}],46:[function(require,module,exports){
module.exports = function(Handlebars) {

var templates = {};

templates[&quot;components.nav&quot;] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,&#x27;&gt;= 1.0.0&#x27;];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = &quot;&quot;, stack1, stack2, functionType=&quot;function&quot;, escapeExpression=this.escapeExpression, self=this;

function program1(depth0,data) {
  
  var buffer = &quot;&quot;;
  buffer += &quot; &quot;
    + escapeExpression((typeof depth0 === functionType ? depth0.apply(depth0) : depth0));
  return buffer;
  }

  buffer += &quot;&lt;li&gt;\n    &lt;a class=\&quot;&quot;
    + escapeExpression(((stack1 = ((stack1 = depth0.CSS),stack1 == null || stack1 === false ? stack1 : stack1.btn)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1));
  stack2 = helpers.each.call(depth0, depth0.class_in, {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});
  if(stack2 || stack2 === 0) { buffer += stack2; }
  buffer += &quot;\&quot; href=\&quot;#\&quot;&gt;\n        &quot;;
  if (stack2 = helpers.label) { stack2 = stack2.call(depth0, {hash:{},data:data}); }
  else { stack2 = depth0.label; stack2 = typeof stack2 === functionType ? stack2.apply(depth0) : stack2; }
  buffer += escapeExpression(stack2)
    + &quot;\n    &lt;/a&gt;\n&lt;/li&gt;&quot;;
  return buffer;
  });

templates[&quot;components.scroll&quot;] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,&#x27;&gt;= 1.0.0&#x27;];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = &quot;&quot;, stack1, functionType=&quot;function&quot;, escapeExpression=this.escapeExpression;


  buffer += &quot;&lt;div class=\&quot;&quot;
    + escapeExpression(((stack1 = ((stack1 = depth0.CSS),stack1 == null || stack1 === false ? stack1 : stack1.scroll_box_content)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + &quot;\&quot;&gt;\n&lt;/div&gt;&quot;;
  return buffer;
  });

templates[&quot;history&quot;] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,&#x27;&gt;= 1.0.0&#x27;];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = &quot;&quot;, stack1, functionType=&quot;function&quot;, escapeExpression=this.escapeExpression;


  buffer += &quot;&lt;div class=\&quot;&quot;
    + escapeExpression(((stack1 = ((stack1 = depth0.CSS),stack1 == null || stack1 === false ? stack1 : stack1.history)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + &quot;\&quot;&gt;\n&lt;/div&gt;&quot;;
  return buffer;
  });

templates[&quot;layer&quot;] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,&#x27;&gt;= 1.0.0&#x27;];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = &quot;&quot;, stack1, stack2, options, functionType=&quot;function&quot;, escapeExpression=this.escapeExpression, helperMissing=helpers.helperMissing, self=this;

function program1(depth0,data) {
  
  var buffer = &quot;&quot;;
  buffer += &quot; &quot;
    + escapeExpression((typeof depth0 === functionType ? depth0.apply(depth0) : depth0));
  return buffer;
  }

function program3(depth0,data) {
  
  var buffer = &quot;&quot;, stack1, options;
  buffer += &quot;\n                                &lt;li&gt;&lt;a class=\&quot;&quot;
    + escapeExpression(((stack1 = depth0.id),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + &quot;\&quot; href=\&quot;#\&quot;&gt;&quot;;
  options = {hash:{},data:data};
  buffer += escapeExpression(((stack1 = helpers.prefix || depth0.prefix),stack1 ? stack1.call(depth0, depth0.msg, &quot;sorter-prefix&quot;, depth0.id, options) : helperMissing.call(depth0, &quot;prefix&quot;, depth0.msg, &quot;sorter-prefix&quot;, depth0.id, options)))
    + &quot;&lt;/a&gt;&lt;/li&gt;\n                            &quot;;
  return buffer;
  }

function program5(depth0,data) {
  
  var buffer = &quot;&quot;, stack1, options;
  buffer += &quot;\n                            &lt;li&gt;&lt;a class=\&quot;&quot;
    + escapeExpression(((stack1 = depth0.id),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + &quot;\&quot; href=\&quot;#\&quot;&gt;&quot;;
  options = {hash:{},data:data};
  buffer += escapeExpression(((stack1 = helpers.prefix || depth0.prefix),stack1 ? stack1.call(depth0, depth0.msg, &quot;filter-prefix&quot;, depth0.id, options) : helperMissing.call(depth0, &quot;prefix&quot;, depth0.msg, &quot;filter-prefix&quot;, depth0.id, options)))
    + &quot;&lt;/a&gt;&lt;/li&gt;\n                        &quot;;
  return buffer;
  }

  buffer += &quot;&lt;div class=\&quot;&quot;
    + escapeExpression(((stack1 = ((stack1 = depth0.CSS),stack1 == null || stack1 === false ? stack1 : stack1.layer)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1));
  stack2 = helpers.each.call(depth0, depth0.class_in, {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});
  if(stack2 || stack2 === 0) { buffer += stack2; }
  buffer += &quot;\&quot;&gt;\n    &lt;div class=\&quot;&quot;
    + escapeExpression(((stack1 = ((stack1 = depth0.CSS),stack1 == null || stack1 === false ? stack1 : stack1.menu)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + &quot; container-fluid\&quot;&gt;\n        &lt;div class=\&quot;row\&quot;&gt;\n            &lt;div class=\&quot;col-lg-offset-2 col-md-offset-1 col-xs-offset-0 col-lg-5 col-md-6 col-xs-7 &quot;
    + escapeExpression(((stack1 = ((stack1 = depth0.CSS),stack1 == null || stack1 === false ? stack1 : stack1.filter)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + &quot;\&quot;&gt;\n                &lt;div class=\&quot;input-group\&quot;&gt;\n                    &lt;input type=\&quot;text\&quot; class=\&quot;form-control\&quot; aria-label=\&quot;...\&quot;&gt;\n\n                    &lt;div class=\&quot;input-group-btn\&quot;&gt;\n                        &lt;button type=\&quot;button\&quot; class=\&quot;btn btn-default &quot;
    + escapeExpression(((stack1 = ((stack1 = depth0.CSS),stack1 == null || stack1 === false ? stack1 : stack1.filter_btn)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + &quot;\&quot;\n                                aria-expanded=\&quot;false\&quot;&gt; &quot;;
  options = {hash:{},data:data};
  buffer += escapeExpression(((stack1 = helpers.get_msg || depth0.get_msg),stack1 ? stack1.call(depth0, depth0.msg, &quot;filter&quot;, options) : helperMissing.call(depth0, &quot;get_msg&quot;, depth0.msg, &quot;filter&quot;, options)))
    + &quot; &lt;span&gt;&lt;/span&gt;&lt;/button&gt;\n                        &lt;button type=\&quot;button\&quot; class=\&quot;btn btn-default dropdown-toggle\&quot; data-toggle=\&quot;dropdown\&quot;\n                                aria-expanded=\&quot;false\&quot;&gt; &quot;;
  options = {hash:{},data:data};
  buffer += escapeExpression(((stack1 = helpers.get_msg || depth0.get_msg),stack1 ? stack1.call(depth0, depth0.msg, &quot;filter_options&quot;, options) : helperMissing.call(depth0, &quot;get_msg&quot;, depth0.msg, &quot;filter_options&quot;, options)))
    + &quot; &lt;span class=\&quot;caret\&quot;&gt;&lt;/span&gt;\n                        &lt;/button&gt;\n                        &lt;ul class=\&quot;dropdown-menu dropdown-menu-right\&quot; role=\&quot;menu\&quot;&gt;\n                            &quot;;
  stack2 = helpers.each.call(depth0, depth0.filter, {hash:{},inverse:self.noop,fn:self.program(3, program3, data),data:data});
  if(stack2 || stack2 === 0) { buffer += stack2; }
  buffer += &quot;\n                        &lt;/ul&gt;\n                    &lt;/div&gt;\n                    &lt;!-- /btn-group --&gt;\n                &lt;/div&gt;\n                &lt;!-- /input-group --&gt;\n            &lt;/div&gt;\n            &lt;div class=\&quot;col-lg-3 col-md-4 col-xs-5 &quot;
    + escapeExpression(((stack1 = ((stack1 = depth0.CSS),stack1 == null || stack1 === false ? stack1 : stack1.sorter)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + &quot;\&quot;&gt;\n                &lt;div class=\&quot;dropdown\&quot;&gt;\n                    &lt;label class=\&quot;control-label\&quot; for=\&quot;sortDropDown\&quot;\n                           style=\&quot;text-align:right\&quot;&gt;&quot;;
  options = {hash:{},data:data};
  buffer += escapeExpression(((stack1 = helpers.get_msg || depth0.get_msg),stack1 ? stack1.call(depth0, depth0.msg, &quot;sorter&quot;, options) : helperMissing.call(depth0, &quot;get_msg&quot;, depth0.msg, &quot;sorter&quot;, options)))
    + &quot;&lt;/label&gt;\n                    &lt;button class=\&quot;btn btn-default dropdown-toggle\&quot; type=\&quot;button\&quot; id=\&quot;sortDropDown\&quot;\n                            data-toggle=\&quot;dropdown\&quot; aria-expanded=\&quot;true\&quot;&gt;\n                        &quot;;
  options = {hash:{},data:data};
  buffer += escapeExpression(((stack1 = helpers.get_msg || depth0.get_msg),stack1 ? stack1.call(depth0, depth0.msg, &quot;sorter_default&quot;, options) : helperMissing.call(depth0, &quot;get_msg&quot;, depth0.msg, &quot;sorter_default&quot;, options)))
    + &quot;\n                        &lt;span class=\&quot;caret\&quot;&gt;&lt;/span&gt;\n                    &lt;/button&gt;\n                    &lt;ul class=\&quot;col-sm-8 dropdown-menu\&quot; role=\&quot;menu\&quot; aria-labelledby=\&quot;sortDropDown\&quot;&gt;\n                        &quot;;
  stack2 = helpers.each.call(depth0, depth0.sorter, {hash:{},inverse:self.noop,fn:self.program(5, program5, data),data:data});
  if(stack2 || stack2 === 0) { buffer += stack2; }
  buffer += &quot;\n                    &lt;/ul&gt;\n                &lt;/div&gt;\n            &lt;/div&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n    &lt;div class=\&quot;&quot;
    + escapeExpression(((stack1 = ((stack1 = depth0.CSS),stack1 == null || stack1 === false ? stack1 : stack1.layout_container)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + &quot;\&quot;&gt;\n\n    &lt;/div&gt;\n    &lt;div class=\&quot;&quot;
    + escapeExpression(((stack1 = ((stack1 = depth0.CSS),stack1 == null || stack1 === false ? stack1 : stack1.layout_footer)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + &quot;\&quot;&gt;\n        &quot;;
  options = {hash:{},data:data};
  buffer += escapeExpression(((stack1 = helpers.get_msg || depth0.get_msg),stack1 ? stack1.call(depth0, depth0.msg, &quot;empty&quot;, options) : helperMissing.call(depth0, &quot;get_msg&quot;, depth0.msg, &quot;empty&quot;, options)))
    + &quot;\n    &lt;/div&gt;\n&lt;/div&gt;&quot;;
  return buffer;
  });

templates[&quot;overlay&quot;] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,&#x27;&gt;= 1.0.0&#x27;];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = &quot;&quot;, stack1, stack2, functionType=&quot;function&quot;, escapeExpression=this.escapeExpression, helperMissing=helpers.helperMissing, self=this;

function program1(depth0,data) {
  
  var buffer = &quot;&quot;, stack1, options;
  buffer += &quot;\n                        &lt;li&gt;&lt;a id=\&quot;&quot;
    + escapeExpression(((stack1 = depth0.id),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + &quot;\&quot; href=\&quot;#\&quot;&gt;&quot;;
  options = {hash:{},data:data};
  buffer += escapeExpression(((stack1 = helpers.get_filter || depth0.get_filter),stack1 ? stack1.call(depth0, depth0.msg, depth0.id, options) : helperMissing.call(depth0, &quot;get_filter&quot;, depth0.msg, depth0.id, options)))
    + &quot;&lt;/a&gt;&lt;/li&gt;\n                    &quot;;
  return buffer;
  }

  buffer += &quot;&lt;div class=\&quot;&quot;
    + escapeExpression(((stack1 = ((stack1 = depth0.CSS),stack1 == null || stack1 === false ? stack1 : stack1.overlay)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + &quot;\&quot; style=\&quot;z-index : &quot;;
  if (stack2 = helpers.z_index) { stack2 = stack2.call(depth0, {hash:{},data:data}); }
  else { stack2 = depth0.z_index; stack2 = typeof stack2 === functionType ? stack2.apply(depth0) : stack2; }
  buffer += escapeExpression(stack2)
    + &quot;;\&quot;&gt;\n    &lt;div class=\&quot;&quot;
    + escapeExpression(((stack1 = ((stack1 = depth0.CSS),stack1 == null || stack1 === false ? stack1 : stack1.menu)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + &quot; navbar\&quot;&gt;\n        &lt;div class=\&quot;container\&quot;&gt;\n            &lt;div class=\&quot;navbar-header syn_menu_label navbar-left\&quot;&gt;\n                &lt;a class=\&quot;navbar-brand\&quot; disabled=\&quot;\&quot;&gt;\n                    &lt;b&gt;&quot;;
  if (stack2 = helpers.label) { stack2 = stack2.call(depth0, {hash:{},data:data}); }
  else { stack2 = depth0.label; stack2 = typeof stack2 === functionType ? stack2.apply(depth0) : stack2; }
  buffer += escapeExpression(stack2)
    + &quot;&lt;/b&gt;\n                    &lt;small&gt;&quot;;
  if (stack2 = helpers.label_small) { stack2 = stack2.call(depth0, {hash:{},data:data}); }
  else { stack2 = depth0.label_small; stack2 = typeof stack2 === functionType ? stack2.apply(depth0) : stack2; }
  buffer += escapeExpression(stack2)
    + &quot;&lt;/small&gt;\n                &lt;/a&gt;\n            &lt;/div&gt;\n            &lt;div class=\&quot;collapse navbar-collapse syn_navbar_collapse navbar-right\&quot;&gt;\n                &lt;ul class=\&quot;&quot;
    + escapeExpression(((stack1 = ((stack1 = depth0.CSS),stack1 == null || stack1 === false ? stack1 : stack1.overlay_menu)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + &quot; nav navbar-nav\&quot;&gt;\n                    &quot;;
  stack2 = helpers.each.call(depth0, depth0.nav, {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});
  if(stack2 || stack2 === 0) { buffer += stack2; }
  buffer += &quot;\n                &lt;/ul&gt;\n            &lt;/div&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n    &lt;div class=\&quot;&quot;
    + escapeExpression(((stack1 = ((stack1 = depth0.CSS),stack1 == null || stack1 === false ? stack1 : stack1.overlay_content)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + &quot;\&quot;&gt;\n    &lt;/div&gt;\n&lt;/div&gt;&quot;;
  return buffer;
  });

templates[&quot;overlay_container&quot;] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,&#x27;&gt;= 1.0.0&#x27;];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = &quot;&quot;, stack1, functionType=&quot;function&quot;, escapeExpression=this.escapeExpression;


  buffer += &quot;&lt;div class=\&quot;&quot;
    + escapeExpression(((stack1 = ((stack1 = depth0.CSS),stack1 == null || stack1 === false ? stack1 : stack1.overlay_container)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + &quot;\&quot;&gt;\n&lt;/div&gt;&quot;;
  return buffer;
  });

templates[&quot;progress&quot;] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,&#x27;&gt;= 1.0.0&#x27;];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = &quot;&quot;, stack1, functionType=&quot;function&quot;, escapeExpression=this.escapeExpression;


  buffer += &quot;&lt;div class=\&quot;&quot;
    + escapeExpression(((stack1 = ((stack1 = depth0.CSS),stack1 == null || stack1 === false ? stack1 : stack1.progress_container_wrap)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + &quot; col-lg-offset-1 col-md-offset-1 col-xs-offset-1 col-lg-10 col-md-10 col-xs-10\&quot;&gt;\n    &lt;div class=\&quot;&quot;
    + escapeExpression(((stack1 = ((stack1 = depth0.CSS),stack1 == null || stack1 === false ? stack1 : stack1.progress_container)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + &quot;\&quot;&gt; &lt;/div&gt;\n&lt;/div&gt;&quot;;
  return buffer;
  });

templates[&quot;progress_bar&quot;] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,&#x27;&gt;= 1.0.0&#x27;];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = &quot;&quot;, stack1, functionType=&quot;function&quot;, escapeExpression=this.escapeExpression;


  buffer += &quot;&lt;div class=\&quot;col-lg-2 col-md-3 col-xs-4\&quot; style=\&quot;display: flex; flex-direction: column; justify-content: center;\&quot;&gt;\n    &lt;div&gt;\n        &quot;;
  if (stack1 = helpers.label) { stack1 = stack1.call(depth0, {hash:{},data:data}); }
  else { stack1 = depth0.label; stack1 = typeof stack1 === functionType ? stack1.apply(depth0) : stack1; }
  buffer += escapeExpression(stack1)
    + &quot;\n    &lt;/div&gt;\n    &lt;div class=\&quot;progress\&quot;&gt;\n        &lt;div class=\&quot;&quot;
    + escapeExpression(((stack1 = ((stack1 = depth0.CSS),stack1 == null || stack1 === false ? stack1 : stack1.progress_bar)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + &quot; progress-bar progress-bar-success\&quot; style=\&quot;width: 0%\&quot;&gt;&lt;/div&gt;\n    &lt;/div&gt;\n&lt;/div&gt;&quot;;
  return buffer;
  });

templates[&quot;tiles.default&quot;] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,&#x27;&gt;= 1.0.0&#x27;];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = &quot;&quot;, stack1, functionType=&quot;function&quot;, escapeExpression=this.escapeExpression;


  buffer += &quot;&lt;div class=\&quot;&quot;
    + escapeExpression(((stack1 = ((stack1 = depth0.CSS),stack1 == null || stack1 === false ? stack1 : stack1.tile)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + &quot; &quot;
    + escapeExpression(((stack1 = ((stack1 = ((stack1 = depth0.data),stack1 == null || stack1 === false ? stack1 : stack1.detripler)),stack1 == null || stack1 === false ? stack1 : stack1.id)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + &quot; &quot;
    + escapeExpression(((stack1 = ((stack1 = depth0.CSS),stack1 == null || stack1 === false ? stack1 : stack1.semantic_color)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + &quot;\&quot;&gt;\n    &quot;
    + escapeExpression(((stack1 = ((stack1 = depth0.data),stack1 == null || stack1 === false ? stack1 : stack1.label)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + &quot;\n&lt;/div&gt;&quot;;
  return buffer;
  });

templates[&quot;tiles.outgoing.blank&quot;] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,&#x27;&gt;= 1.0.0&#x27;];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = &quot;&quot;, stack1, functionType=&quot;function&quot;, escapeExpression=this.escapeExpression;


  buffer += &quot;&lt;div class=\&quot;&quot;
    + escapeExpression(((stack1 = ((stack1 = depth0.CSS),stack1 == null || stack1 === false ? stack1 : stack1.tile)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + &quot;  &quot;
    + escapeExpression(((stack1 = ((stack1 = ((stack1 = depth0.data),stack1 == null || stack1 === false ? stack1 : stack1.detripler)),stack1 == null || stack1 === false ? stack1 : stack1.id)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + &quot; &quot;
    + escapeExpression(((stack1 = ((stack1 = depth0.CSS),stack1 == null || stack1 === false ? stack1 : stack1.semantic_color)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + &quot;\&quot;&gt;\n    &lt;b&gt;Subgraph:&lt;/b&gt;\n    &lt;div class=\&quot;\&quot;&gt;\n    &lt;/div&gt;\n    &lt;b&gt;is object of:&lt;/b&gt;\n    &lt;div class=\&quot;&quot;
    + escapeExpression(((stack1 = ((stack1 = depth0.CSS),stack1 == null || stack1 === false ? stack1 : stack1.uri)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + &quot; &quot;
    + escapeExpression(((stack1 = ((stack1 = depth0.CSS),stack1 == null || stack1 === false ? stack1 : stack1.dynamic_text_size)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + &quot;\&quot;&gt;\n        &quot;
    + escapeExpression(((stack1 = ((stack1 = ((stack1 = ((stack1 = depth0.data),stack1 == null || stack1 === false ? stack1 : stack1.draft)),stack1 == null || stack1 === false ? stack1 : stack1.triple)),stack1 == null || stack1 === false ? stack1 : stack1.predicate)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + &quot;\n    &lt;/div&gt;\n&lt;/div&gt;&quot;;
  return buffer;
  });

templates[&quot;tiles.outgoing.literal&quot;] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,&#x27;&gt;= 1.0.0&#x27;];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = &quot;&quot;, stack1, functionType=&quot;function&quot;, escapeExpression=this.escapeExpression;


  buffer += &quot;&lt;div class=\&quot;&quot;
    + escapeExpression(((stack1 = ((stack1 = depth0.CSS),stack1 == null || stack1 === false ? stack1 : stack1.tile)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + &quot; &quot;
    + escapeExpression(((stack1 = ((stack1 = depth0.CSS),stack1 == null || stack1 === false ? stack1 : stack1.literal)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + &quot; &quot;
    + escapeExpression(((stack1 = ((stack1 = ((stack1 = depth0.data),stack1 == null || stack1 === false ? stack1 : stack1.detripler)),stack1 == null || stack1 === false ? stack1 : stack1.id)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + &quot; &quot;
    + escapeExpression(((stack1 = ((stack1 = depth0.CSS),stack1 == null || stack1 === false ? stack1 : stack1.semantic_color)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + &quot;\&quot;&gt;\n    &lt;b&gt;Value:&lt;/b&gt;\n    &lt;div class=\&quot;&quot;
    + escapeExpression(((stack1 = ((stack1 = depth0.CSS),stack1 == null || stack1 === false ? stack1 : stack1.dynamic_text_size)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + &quot; &quot;
    + escapeExpression(((stack1 = ((stack1 = depth0.CSS),stack1 == null || stack1 === false ? stack1 : stack1.shrink)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + &quot; &quot;
    + escapeExpression(((stack1 = ((stack1 = depth0.CSS),stack1 == null || stack1 === false ? stack1 : stack1.y_scroll)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + &quot;\&quot;&gt;\n        &quot;
    + escapeExpression(((stack1 = ((stack1 = ((stack1 = ((stack1 = depth0.data),stack1 == null || stack1 === false ? stack1 : stack1.draft)),stack1 == null || stack1 === false ? stack1 : stack1.triple)),stack1 == null || stack1 === false ? stack1 : stack1.object)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + &quot;\n    &lt;/div&gt;\n    &lt;b&gt;is object of:&lt;/b&gt;\n    &lt;div class=\&quot;&quot;
    + escapeExpression(((stack1 = ((stack1 = depth0.CSS),stack1 == null || stack1 === false ? stack1 : stack1.uri)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + &quot; &quot;
    + escapeExpression(((stack1 = ((stack1 = depth0.CSS),stack1 == null || stack1 === false ? stack1 : stack1.dynamic_text_size)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + &quot;\&quot;&gt;\n        &quot;
    + escapeExpression(((stack1 = ((stack1 = ((stack1 = ((stack1 = depth0.data),stack1 == null || stack1 === false ? stack1 : stack1.draft)),stack1 == null || stack1 === false ? stack1 : stack1.triple)),stack1 == null || stack1 === false ? stack1 : stack1.predicate)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + &quot;\n    &lt;/div&gt;\n&lt;/div&gt;&quot;;
  return buffer;
  });

templates[&quot;tiles.outgoing.named&quot;] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {
  this.compilerInfo = [4,&#x27;&gt;= 1.0.0&#x27;];
helpers = this.merge(helpers, Handlebars.helpers); data = data || {};
  var buffer = &quot;&quot;, stack1, functionType=&quot;function&quot;, escapeExpression=this.escapeExpression;


  buffer += &quot;&lt;div class=\&quot;&quot;
    + escapeExpression(((stack1 = ((stack1 = depth0.CSS),stack1 == null || stack1 === false ? stack1 : stack1.tile)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + &quot;  &quot;
    + escapeExpression(((stack1 = ((stack1 = ((stack1 = depth0.data),stack1 == null || stack1 === false ? stack1 : stack1.detripler)),stack1 == null || stack1 === false ? stack1 : stack1.id)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + &quot; &quot;
    + escapeExpression(((stack1 = ((stack1 = depth0.CSS),stack1 == null || stack1 === false ? stack1 : stack1.semantic_color)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + &quot;\&quot;&gt;\n    &lt;b&gt;Resource:&lt;/b&gt;\n    &lt;div class=\&quot;&quot;
    + escapeExpression(((stack1 = ((stack1 = depth0.CSS),stack1 == null || stack1 === false ? stack1 : stack1.uri)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + &quot; &quot;
    + escapeExpression(((stack1 = ((stack1 = depth0.CSS),stack1 == null || stack1 === false ? stack1 : stack1.dynamic_text_size)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + &quot;\&quot;&gt;\n        &quot;
    + escapeExpression(((stack1 = ((stack1 = ((stack1 = ((stack1 = depth0.data),stack1 == null || stack1 === false ? stack1 : stack1.draft)),stack1 == null || stack1 === false ? stack1 : stack1.triple)),stack1 == null || stack1 === false ? stack1 : stack1.object)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + &quot;\n    &lt;/div&gt;\n    &lt;b&gt;is object of:&lt;/b&gt;\n    &lt;div class=\&quot;&quot;
    + escapeExpression(((stack1 = ((stack1 = depth0.CSS),stack1 == null || stack1 === false ? stack1 : stack1.uri)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + &quot; &quot;
    + escapeExpression(((stack1 = ((stack1 = depth0.CSS),stack1 == null || stack1 === false ? stack1 : stack1.dynamic_text_size)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + &quot;\&quot;&gt;\n        &quot;
    + escapeExpression(helpers.log.call(depth0, ((stack1 = ((stack1 = ((stack1 = depth0.data),stack1 == null || stack1 === false ? stack1 : stack1.draft)),stack1 == null || stack1 === false ? stack1 : stack1.triple)),stack1 == null || stack1 === false ? stack1 : stack1.predicate), {hash:{},data:data}))
    + &quot;\n        &quot;
    + escapeExpression(((stack1 = ((stack1 = ((stack1 = ((stack1 = depth0.data),stack1 == null || stack1 === false ? stack1 : stack1.draft)),stack1 == null || stack1 === false ? stack1 : stack1.triple)),stack1 == null || stack1 === false ? stack1 : stack1.predicate)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))
    + &quot;\n    &lt;/div&gt;\n&lt;/div&gt;&quot;;
  return buffer;
  });

return templates;

};
},{}],47:[function(require,module,exports){
(function (global){
var Handlebars = (typeof window !== &quot;undefined&quot; ? window[&#x27;Handlebars&#x27;] : typeof global !== &quot;undefined&quot; ? global[&#x27;Handlebars&#x27;] : null);

// Helper to get message behind str identifier
Handlebars.registerHelper(&#x27;get_msg&#x27;, function (msg, str) {
    return msg.get(str);
});

// Helper to prefix given str with type stored under general_plugin module
Handlebars.registerHelper(&#x27;prefix&#x27;, function (msg, type, str) {
    return msg.get(require(&quot;./const/general_plugin&quot;)[type] + str);
});

// Helper prints to console
//Handlebars.registerHelper(&#x27;log&#x27;, function (obj) {
//    console.log(obj);
//});

var templates = require(&quot;./templates.js&quot;)(Handlebars);
module.exports = templates;
}).call(this,typeof global !== &quot;undefined&quot; ? global : typeof self !== &quot;undefined&quot; ? self : typeof window !== &quot;undefined&quot; ? window : {})
},{&quot;./const/general_plugin&quot;:3,&quot;./templates.js&quot;:46}],48:[function(require,module,exports){
(function (global){
/**
* Extends an object with backbone events and switching. A switch is a event which is triggered once and stays &quot;on&quot;. If a function gets bond to a switch in on state it is invoked instantly.
**/

var Backbone = (typeof window !== &quot;undefined&quot; ? window[&#x27;Backbone&#x27;] : typeof global !== &quot;undefined&quot; ? global[&#x27;Backbone&#x27;] : null), $ = (typeof window !== &quot;undefined&quot; ? window[&#x27;$&#x27;] : typeof global !== &quot;undefined&quot; ? global[&#x27;$&#x27;] : null);

module.exports = function(obj) {
    obj = $.extend(obj, Backbone.Events);
    if (!obj._saved_switches) {
        obj._saved_switches = {};
    }
    obj.on_switch = function(event, callback, context) {
        if(obj._saved_switches[event]) {
            callback();
        } else {
            obj.once(&quot;switch:&quot; + event, callback, context)
        }
    };
    obj.trigger_switch = function(event) {
        obj._saved_switches[event] = true;
        obj.trigger(&quot;switch:&quot; + event)
    };
    return obj;
};
}).call(this,typeof global !== &quot;undefined&quot; ? global : typeof self !== &quot;undefined&quot; ? self : typeof window !== &quot;undefined&quot; ? window : {})
},{}],49:[function(require,module,exports){
(function (global){
var Modernizr = (typeof window !== &quot;undefined&quot; ? window[&#x27;Modernizr&#x27;] : typeof global !== &quot;undefined&quot; ? global[&#x27;Modernizr&#x27;] : null);
var transEndEventName = function() {
    var transEndEventNames = {
        &#x27;WebkitTransition&#x27; : &#x27;webkitTransitionEnd&#x27;,
        &#x27;MozTransition&#x27; : &#x27;transitionend&#x27;,
        &#x27;OTransition&#x27; : &#x27;oTransitionEnd&#x27;,
        &#x27;msTransition&#x27; : &#x27;MSTransitionEnd&#x27;,
        &#x27;transition&#x27; : &#x27;transitionend&#x27;
    };
    // transition end event name
    return transEndEventNames[Modernizr.prefixed(&#x27;transition&#x27;)];
}();
var supportTransitions = Modernizr.csstransitions;

module.exports = {
    /**
     * Get browser dependent event names. (Uses Modernizr)
     *
     * @method getTransEndEventName
     * @return {String} TransitionEnd event name of the current browser
     */
    getTransEndEventName : function() {
        return transEndEventName;
    },

    /**
     * Checks of transitions support is available.
     *
     * @method checkTransitionSupport
     * @return {Boolean}
     */
    getTransitionSupport : function() {
        // transitions support available?
        return supportTransitions;
    }
};
}).call(this,typeof global !== &quot;undefined&quot; ? global : typeof self !== &quot;undefined&quot; ? self : typeof window !== &quot;undefined&quot; ? window : {})
},{}],50:[function(require,module,exports){
var log = require(&quot;../logger.js&quot;)(&quot;Util&quot;);

module.exports = {
    opt_get: function (opt, idSeq) {
        var path = idSeq.split(&quot;.&quot;);
        var cur = opt;
        for (var i = 0; i &lt; path.length; i++) {
            if (cur.hasOwnProperty(path[i])) {
                cur = cur[path[i]];
            } else {
                log(&quot;Option &quot; + idSeq + &quot; not found.&quot;);
                return null;
            }
        }
        return cur;
    },
    add_slashes: function (str) {
        return str.replace(/\\/g, &#x27;\\\\&#x27;).
            replace(/\u0008/g, &#x27;\\b&#x27;).
            replace(/\t/g, &#x27;\\t&#x27;).
            replace(/\n/g, &#x27;\\n&#x27;).
            replace(/\f/g, &#x27;\\f&#x27;).
            replace(/\r/g, &#x27;\\r&#x27;).
            replace(/&#x27;/g, &#x27;\\\&#x27;&#x27;).
            replace(/&quot;/g, &#x27;\\&quot;&#x27;);
    },
    constr : function(constructor, args) {
        function F() {
            return constructor.apply(this, args);
        }
        F.prototype = constructor.prototype;
        return new F();
    },
    arrayObjectIndexOf : function(myArray, searchTerm, property) {
    for(var i = 0, len = myArray.length; i &lt; len; i++) {
        if (myArray[i][property] === searchTerm) return i;
    }
    return -1;
    },
    delay : (function(){
        var timer = 0;
        return function(callback, ms){
            clearTimeout (timer);
            timer = setTimeout(callback, ms);
        };
    })()
};
},{&quot;../logger.js&quot;:37}]},{},[45]);

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
